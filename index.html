<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgriCV</title>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P6ZPGS5VKV"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-P6ZPGS5VKV');
</script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #059669;
            --primary-dark: #047857;
            --primary-light: #34d399;
            --accent: #f59e0b;
            --accent-dark: #d97706;
            --bg-dark: #0a0f0d;
            --bg-card: #111916;
            --bg-input: #1a2420;
            --text-primary: #f0fdf4;
            --text-secondary: #9ca3af;
            --border: #1f3a2f;
            --success: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
            overflow-x: hidden;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .font-display {
            font-family: 'Space Grotesk', 'Tajawal', sans-serif;
        }

        .bg-pattern {
            background-image: 
                radial-gradient(ellipse at 20% 30%, rgba(5, 150, 105, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 70%, rgba(245, 158, 11, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(16, 185, 129, 0.05) 0%, transparent 70%);
        }

        .grid-pattern {
            background-image: 
                linear-gradient(rgba(5, 150, 105, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(5, 150, 105, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
        }

        .glass {
            background: rgba(17, 25, 22, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(5, 150, 105, 0.2);
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }

        .input-field {
            background: var(--bg-input);
            border: 2px solid var(--border);
            color: var(--text-primary);
            padding: 14px 18px;
            border-radius: 12px;
            width: 100%;
            font-size: 16px;
            transition: all 0.3s ease;
            font-family: 'Tajawal', sans-serif;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(5, 150, 105, 0.2);
        }

        .input-field.error {
            border-color: var(--error);
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 14px 32px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 16px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(5, 150, 105, 0.4);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: transparent;
            color: var(--primary);
            padding: 14px 32px;
            border-radius: 12px;
            font-weight: 700;
            font-size: 16px;
            border: 2px solid var(--primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: rgba(5, 150, 105, 0.1);
        }

        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 24px;
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: var(--primary);
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fadeInUp {
            animation: fadeInUp 0.6s ease forwards;
        }

        .toast-container {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            padding: 16px 24px;
            border-radius: 12px;
            font-weight: 500;
            animation: toastIn 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toast.success {
            background: rgba(16, 185, 129, 0.2);
            border: 1px solid var(--success);
            color: var(--success);
        }

        .toast.error {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid var(--error);
            color: var(--error);
        }

        .toast.warning {
            background: rgba(245, 158, 11, 0.2);
            border: 1px solid var(--warning);
            color: var(--warning);
        }

        @keyframes toastIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 32px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal-content {
            transform: scale(1);
        }

        .cv-preview {
            background: white;
            color: #1a1a1a;
            padding: 40px;
            font-family: 'Segoe UI', Tahoma, sans-serif;
        }

        .loader {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .help-btn {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: rgba(5, 150, 105, 0.2);
            color: var(--primary);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            transition: all 0.3s ease;
            border: 1px solid rgba(5, 150, 105, 0.3);
        }

        .help-btn:hover {
            background: var(--primary);
            color: white;
        }

        .help-tooltip {
            position: relative;
        }

        .help-content {
            position: absolute;
            bottom: calc(100% + 10px);
            right: 0;
            background: var(--bg-card);
            border: 1px solid var(--primary);
            padding: 12px 16px;
            border-radius: 12px;
            font-size: 13px;
            width: 280px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 100;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .help-tooltip.active .help-content {
            opacity: 1;
            visibility: visible;
        }

        .checkbox-custom {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .checkbox-custom input {
            display: none;
        }

        .checkbox-custom .checkmark {
            width: 22px;
            height: 22px;
            border: 2px solid var(--border);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .checkbox-custom input:checked + .checkmark {
            background: var(--primary);
            border-color: var(--primary);
        }

        .checkbox-custom input:checked + .checkmark svg {
            opacity: 1;
        }

        .checkbox-custom .checkmark svg {
            opacity: 0;
            width: 14px;
            height: 14px;
            color: white;
        }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        @media (max-width: 768px) {
            .input-field {
                padding: 12px 14px;
                font-size: 14px;
            }

            .btn-primary, .btn-secondary {
                padding: 12px 24px;
                font-size: 14px;
            }

            .card {
                padding: 16px;
            }

            .cv-preview {
                padding: 20px;
            }
        }
    </style>
</head>
<body class="bg-pattern grid-pattern">
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Name Entry Screen -->
    <div id="nameScreen" class="min-h-screen flex items-center justify-center p-4">
        <div class="max-w-md w-full">
            <div class="text-center mb-8 animate-fadeInUp">
                <div class="w-20 h-20 mx-auto mb-6 rounded-2xl bg-gradient-to-br from-emerald-500 to-emerald-700 flex items-center justify-center">
                    <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                </div>
                <h1 class="text-3xl md:text-4xl font-bold mb-3 font-display">
                    <span class="text-emerald-400">Agri</span><span class="text-white">CV</span>
                </h1>
                <p class="text-gray-400 text-lg">منصة إنشاء السيرة الذاتية لخريجي الزراعة</p>
            </div>

            <div class="card animate-fadeInUp" style="animation-delay: 0.2s">
                <h2 class="text-xl font-bold mb-6 text-center">مرحبا! ما اسمك؟</h2>
                <form id="nameForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">الاسم الكامل</label>
                        <input type="text" id="userName" class="input-field" placeholder="أدخل اسمك الرباعي" required>
                        <p class="text-xs text-gray-500 mt-2">سيُستخدم هذا الاسم في السيرة الذاتية</p>
                    </div>
                    <button type="submit" class="btn-primary w-full">
                        ابدأ الآن
                        <svg class="inline-block w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l-5 5m0 0l5 5m-5-5h12"></path>
                        </svg>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <!-- Welcome Screen -->
    <div id="welcomeScreen" class="min-h-screen hidden">
        <!-- Navigation -->
        <nav class="glass fixed top-0 left-0 right-0 z-50 px-4 py-3">
            <div class="max-w-7xl mx-auto flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-emerald-500 to-emerald-700 flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                    <span class="font-bold text-xl font-display"><span class="text-emerald-400">Agri</span>CV</span>
                </div>
                <div class="flex items-center gap-4">
                    <span class="text-gray-400 text-sm hidden md:block" id="welcomeName">مرحباً، </span>
                    <button id="profileBtn" class="w-10 h-10 rounded-full bg-emerald-600 flex items-center justify-center font-bold text-white hover:bg-emerald-500 transition-colors">
                        م
                    </button>
                </div>
            </div>
        </nav>

        <!-- Hero Section -->
        <section class="pt-32 pb-20 px-4">
            <div class="max-w-7xl mx-auto">
                <div class="text-center mb-16">
                    <h1 class="text-4xl md:text-6xl font-bold mb-6 font-display animate-fadeInUp">
                        <span id="heroGreeting">أهلاً بك</span>
                        <br>
                        <span class="text-emerald-400">صمم سيرتك الذاتية</span>
                        <br>
                        <span class="text-amber-400">بكل سهولة</span>
                    </h1>
                    <p class="text-gray-400 text-lg md:text-xl max-w-2xl mx-auto mb-8 animate-fadeInUp" style="animation-delay: 0.2s">
                        منصة متخصصة لمساعدة طلاب وخريجي كلية الزراعة في إنشاء سيرة ذاتية احترافية متوافقة مع أنظمة التتبع ATS
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center animate-fadeInUp" style="animation-delay: 0.4s">
                        <button id="createCVBtn" class="btn-primary text-lg px-8 py-4">
                            <svg class="inline-block w-6 h-6 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                            </svg>
                            إنشاء سيرة ذاتية جديدة
                        </button>
                        <button id="myCVsBtn" class="btn-secondary text-lg px-8 py-4">
                            <svg class="inline-block w-6 h-6 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            سيرتي الذاتية
                        </button>
                    </div>
                </div>

                <!-- Features -->
                <div class="grid md:grid-cols-3 gap-6 mb-16">
                    <div class="card text-center animate-fadeInUp" style="animation-delay: 0.3s">
                        <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-emerald-500/20 flex items-center justify-center">
                            <svg class="w-8 h-8 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold mb-2">متوافق مع ATS</h3>
                        <p class="text-gray-400">سيرتك الذاتية ستتجاوز أنظمة التتبع بسهولة</p>
                    </div>
                    <div class="card text-center animate-fadeInUp" style="animation-delay: 0.4s">
                        <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-amber-500/20 flex items-center justify-center">
                            <svg class="w-8 h-8 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold mb-2">سهل وسريع</h3>
                        <p class="text-gray-400">خطوات بسيطة مع إرشادات واضحة في كل مرحلة</p>
                    </div>
                    <div class="card text-center animate-fadeInUp" style="animation-delay: 0.5s">
                        <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-blue-500/20 flex items-center justify-center">
                            <svg class="w-8 h-8 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold mb-2">محفوظ وآمن</h3>
                        <p class="text-gray-400">بياناتك محفوظة ويمكنك تعديلها في أي وقت</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="aboutSection" class="py-20 px-4 border-t border-gray-800">
            <div class="max-w-7xl mx-auto">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4 font-display">عن المنصة</h2>
                    <div class="w-20 h-1 bg-emerald-500 mx-auto rounded-full"></div>
                </div>
                <div class="max-w-3xl mx-auto text-center">
                    <p class="text-gray-300 text-lg leading-relaxed mb-6">
                        AgriCV هي منصة متخصصة لمساعدة طلاب وخريجي كلية الزراعة في إنشاء سيرة ذاتية احترافية بشكل سهل ومبسط. نقدم لك خطوات واضحة مع نصائح وإرشادات في كل مرحلة لضمان حصولك على سيرة ذاتية تمثلك بأفضل شكل.
                    </p>
                    <p class="text-gray-400">
                        سواء كنت تبحث عن تدريب، وظيفة أولى، أو فرصة دراسية، نحن هنا لمساعدتك في تقديم نفسك بالشكل الأمثل.
                    </p>
                </div>
            </div>
        </section>
        
        <!-- How to Use Section -->
        <section id="howToUseSection" class="py-20 px-4 border-t border-gray-800 bg-gray-900/30">
            <div class="max-w-7xl mx-auto">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4 font-display">كيف تستخدم الموقع؟</h2>
                    <div class="w-20 h-1 bg-amber-500 mx-auto rounded-full"></div>
                </div>
                <div class="grid md:grid-cols-2 gap-8 items-center">
                    <div>
                        <h3 class="text-2xl font-bold text-emerald-400 mb-4">خطوات بسيطة لإنشاء سيرتك الذاتية</h3>
                        <ul class="space-y-3 text-gray-300">
                            <li class="flex items-start gap-3">
                                <svg class="w-6 h-6 text-emerald-500 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                <span>اضغط على "إنشاء سيرة ذاتية جديدة" واختر اللغة المناسبة.</span>
                            </li>
                            <li class="flex items-start gap-3">
                                <svg class="w-6 h-6 text-emerald-500 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                <span>قم بملء بياناتك خطوة بخطوة (المعلومات الشخصية، التعليم، الخبرات...).</span>
                            </li>
                            <li class="flex items-start gap-3">
                                <svg class="w-6 h-6 text-emerald-500 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                <span>بعد الانتهاء، اضغط "نسخ النص" ثم افتح برنامج "Word" والصق النص.</span>
                            </li>
                            <li class="flex items-start gap-3">
                                <svg class="w-6 h-6 text-emerald-500 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                <span>احفظ الملف على جهازك بصيغة PDF أو Word النهائية.</span>
                            </li>
                        </ul>
                        <div class="mt-8">
                            <a href="https://youtube.com" target="_blank" class="btn-primary inline-flex items-center gap-2">
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/></svg>
                                شاهد شرح الفيديو
                            </a>
                        </div>
                    </div>
                    <div class="card bg-gradient-to-br from-emerald-900/30 to-gray-900 p-8 text-center">
                        <h4 class="text-xl font-bold mb-4 text-amber-400">نصيحة مهمة</h4>
                        <p class="text-gray-300 mb-4">
                            عند الانتهاء من تعبئة البيانات، سيقوم الموقع بنسخ نص منسق وجاهز للصق مباشرة في برنامج "مايكروسوفت وورد" أو أي برنامج تحرير نصوص آخر، مما يسهل عليك التعديل والحفظ.
                        </p>
                        <div class="w-16 h-16 mx-auto rounded-full bg-emerald-500/20 flex items-center justify-center">
                            <svg class="w-8 h-8 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Services Section -->
        <section id="servicesSection" class="py-20 px-4 border-t border-gray-800">
            <div class="max-w-7xl mx-auto">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4 font-display">خدماتنا</h2>
                    <div class="w-20 h-1 bg-amber-500 mx-auto rounded-full"></div>
                </div>
                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="card">
                        <div class="w-12 h-12 rounded-xl bg-emerald-500/20 flex items-center justify-center mb-4">
                            <svg class="w-6 h-6 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                            </svg>
                        </div>
                        <h3 class="text-lg font-bold mb-2">إنشاء CV</h3>
                        <p class="text-gray-400 text-sm">إنشاء سيرة ذاتية احترافية خطوة بخطوة</p>
                    </div>
                    <div class="card">
                        <div class="w-12 h-12 rounded-xl bg-amber-500/20 flex items-center justify-center mb-4">
                            <svg class="w-6 h-6 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path>
                            </svg>
                        </div>
                        <h3 class="text-lg font-bold mb-2">نسخ منسق</h3>
                        <p class="text-gray-400 text-sm">نسخ النص ولصقه في Word بسهولة</p>
                    </div>
                    <div class="card">
                        <div class="w-12 h-12 rounded-xl bg-blue-500/20 flex items-center justify-center mb-4">
                            <svg class="w-6 h-6 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                            </svg>
                        </div>
                        <h3 class="text-lg font-bold mb-2">حفظ وتعديل</h3>
                        <p class="text-gray-400 text-sm">حفظ سيرتك والتعديل عليها متى شئت</p>
                    </div>
                    <div class="card">
                        <div class="w-12 h-12 rounded-xl bg-rose-500/20 flex items-center justify-center mb-4">
                            <svg class="w-6 h-6 text-rose-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"></path>
                            </svg>
                        </div>
                        <h3 class="text-lg font-bold mb-2">ثنائي اللغة</h3>
                        <p class="text-gray-400 text-sm">إنشاء CV بالعربية أو الإنجليزية</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="border-t border-gray-800 py-12 px-4">
            <div class="max-w-7xl mx-auto">
                <div class="flex flex-col md:flex-row items-center justify-between gap-6">
                    <div class="flex items-center gap-3">
                        <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-emerald-500 to-emerald-700 flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                        </div>
                        <span class="font-bold text-xl font-display"><span class="text-emerald-400">Agri</span>CV</span>
                    </div>
                    
                    <div class="flex items-center gap-4">
                        <a href="https://wa.me/201501021670" target="_blank" class="w-10 h-10 rounded-xl bg-gray-800 hover:bg-emerald-600 flex items-center justify-center transition-colors" aria-label="WhatsApp">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
                            </svg>
                        </a>
                        <a href="https://www.facebook.com/share/1F8yR6LeRR/" target="_blank" class="w-10 h-10 rounded-xl bg-gray-800 hover:bg-blue-600 flex items-center justify-center transition-colors" aria-label="Facebook">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                            </svg>
                        </a>
                        <a href="https://www.linkedin.com/in/ahmed-tawheed-165335252" target="_blank" class="w-10 h-10 rounded-xl bg-gray-800 hover:bg-blue-700 flex items-center justify-center transition-colors" aria-label="LinkedIn">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                            </svg>
                        </a>
                        <a href="https://www.instagram.com/ahmadtaw7eed" target="_blank" class="w-10 h-10 rounded-xl bg-gray-800 hover:bg-pink-600 flex items-center justify-center transition-colors" aria-label="Instagram">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                            </svg>
                        </a>
                    </div>

                    <p class="text-gray-500 text-sm">
                        صُمم بكل حب بواسطة 
                        <a href="https://ahmadtawheed.github.io/portfolio/" target="_blank" class="text-emerald-400 hover:text-emerald-300 font-medium transition-colors">أحمد توحيد</a>
                    </p>
                </div>
            </div>
        </footer>
    </div>

    <!-- CV Builder Screen -->
    <div id="builderScreen" class="min-h-screen hidden pb-32">
        <!-- Builder Header -->
        <header class="glass sticky top-0 z-50 px-4 py-3">
            <div class="max-w-5xl mx-auto flex items-center justify-between">
                <button id="backToHome" class="flex items-center gap-2 text-gray-400 hover:text-white transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
                    </svg>
                    رجوع
                </button>
                
                <!-- Step Counter -->
                <div class="flex items-center gap-3 bg-gray-800/50 px-4 py-2 rounded-xl">
                    <span class="text-emerald-400 font-bold" id="currentStepNum">1</span>
                    <span class="text-gray-400">/</span>
                    <span class="text-gray-400" id="totalSteps">16</span>
                </div>
                
                <button id="saveDraftBtn" class="text-sm text-emerald-400 hover:text-emerald-300 transition-colors">
                    حفظ مسودة
                </button>
            </div>
        </header>

        <!-- Step Title -->
        <div class="px-4 py-6 text-center">
            <h2 class="text-xl font-bold" id="stepTitle">اختيار اللغة</h2>
        </div>

        <!-- Step Content -->
        <div class="px-4">
            <div class="max-w-3xl mx-auto" id="stepContent">
                <!-- Step content will be generated by JS -->
            </div>
        </div>

        <!-- Navigation Buttons -->
        <div class="fixed bottom-0 left-0 right-0 glass p-4">
            <div class="max-w-3xl mx-auto flex gap-4">
                <button id="prevStepBtn" class="btn-secondary flex-1 hidden">
                    <svg class="inline-block w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                    </svg>
                    السابق
                </button>
                <button id="nextStepBtn" class="btn-primary flex-1">
                    التالي
                    <svg class="inline-block w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- My CVs Screen -->
    <div id="myCVsScreen" class="min-h-screen hidden">
        <header class="glass sticky top-0 z-50 px-4 py-3">
            <div class="max-w-5xl mx-auto flex items-center justify-between">
                <button id="backFromMyCVs" class="flex items-center gap-2 text-gray-400 hover:text-white transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
                    </svg>
                    رجوع
                </button>
                <h1 class="font-bold text-lg font-display">سيرتي الذاتية</h1>
                <div></div>
            </div>
        </header>

        <div class="px-4 py-8">
            <div class="max-w-5xl mx-auto">
                <div id="cvsList" class="grid md:grid-cols-2 gap-6">
                    <!-- CVs will be rendered here -->
                </div>
                <div id="noCVsMessage" class="text-center py-20 hidden">
                    <div class="w-20 h-20 mx-auto mb-6 rounded-2xl bg-gray-800 flex items-center justify-center">
                        <svg class="w-10 h-10 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                    <h3 class="text-xl font-bold mb-2">لا توجد سير ذاتية</h3>
                    <p class="text-gray-400 mb-6">لم تقم بإنشاء أي سيرة ذاتية بعد</p>
                    <button id="createFirstCV" class="btn-primary">
                        <svg class="inline-block w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                        </svg>
                        إنشاء أول سيرة ذاتية
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- CV Preview Modal -->
    <div id="cvPreviewModal" class="modal-overlay">
        <div class="modal-content max-w-4xl">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold">معاينة السيرة الذاتية</h2>
                <button id="closePreviewModal" class="w-10 h-10 rounded-xl bg-gray-800 hover:bg-gray-700 flex items-center justify-center transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <div class="bg-blue-500/10 border border-blue-500/30 rounded-xl p-4 mb-4">
                <div class="flex items-start gap-3">
                    <svg class="w-6 h-6 text-blue-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <div>
                        <p class="text-blue-400 font-bold mb-1">تعليمات النسخ</p>
                        <p class="text-gray-300 text-sm">اضغط على زر "نسخ النص" بالأسفل، ثم افتح برنامج <strong>Microsoft Word</strong> واضغط <strong>Ctrl + V</strong> للصق.</p>
                    </div>
                </div>
            </div>

            <div id="cvPreviewContent" class="cv-preview rounded-xl overflow-auto max-h-[60vh]">
                <!-- CV preview will be rendered here -->
            </div>
            
            <div class="flex flex-col gap-3 mt-6">
                <button id="copyTextBtn" class="btn-primary w-full text-lg py-4">
                    <svg class="inline-block w-6 h-6 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path>
                    </svg>
                    نسخ النص المنسق (للصق في Word)
                </button>
            </div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="modal-overlay">
        <div class="modal-content">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold">الملف الشخصي</h2>
                <button id="closeProfileModal" class="w-10 h-10 rounded-xl bg-gray-800 hover:bg-gray-700 flex items-center justify-center transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">الاسم</label>
                    <input type="text" id="profileName" class="input-field">
                </div>
                <button id="updateProfileBtn" class="btn-primary w-full">حفظ التغييرات</button>
                <hr class="border-gray-700">
                <button id="deleteAccountBtn" class="w-full py-3 px-4 rounded-xl bg-red-500/20 text-red-400 hover:bg-red-500/30 transition-colors font-medium">
                    حذف الحساب وجميع البيانات
                </button>
            </div>
        </div>
    </div>

    <script>
        // ========== Data & State ==========
        const STEPS = [
            { id: 'language', title: 'اختيار اللغة' },
            { id: 'personal', title: 'المعلومات الشخصية' },
            { id: 'links', title: 'الروابط' },
            { id: 'location', title: 'الموقع' },
            { id: 'summary', title: 'الملخص المهني' },
            { id: 'experience', title: 'الخبرات العملية' },
            { id: 'education', title: 'التعليم' },
            { id: 'projects', title: 'المشاريع' },
            { id: 'volunteering', title: 'التطوع' },
            { id: 'training', title: 'البرامج التدريبية' },
            { id: 'courses', title: 'الكورسات' },
            { id: 'certificates', title: 'الشهادات' },
            { id: 'skills', title: 'المهارات' },
            { id: 'languages', title: 'اللغات' },
            { id: 'interests', title: 'الأنشطة والاهتمامات' },
            { id: 'preview', title: 'المعاينة النهائية' }
        ];

        let currentStep = 0;
        let cvData = {
            language: 'ar',
            personal: { fullName: '', email: '', phone: '' },
            links: [],
            location: { country: '', city: '' },
            summary: '',
            experience: [],
            education: { university: '', faculty: 'كلية الزراعة', month: '', year: '', militaryStatus: '' },
            projects: [],
            volunteering: [],
            training: [],
            courses: [],
            certificates: [],
            skills: [],
            hasLicense: false,
            languages: [{ name: 'العربية', level: 'native' }],
            interests: []
        };

        let userData = JSON.parse(localStorage.getItem('agriCV_user')) || null;
        let savedCVs = JSON.parse(localStorage.getItem('agriCV_cvs')) || [];
        let editingCVId = null;
        let activeHelpTooltips = new Set();

        // ========== Utility Functions ==========
        function showToast(message, type = 'success') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    ${type === 'success' ? '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>' :
                      type === 'error' ? '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>' :
                      '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>'}
                </svg>
                ${message}
            `;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 4000);
        }

        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        function saveData() {
            localStorage.setItem('agriCV_user', JSON.stringify(userData));
            localStorage.setItem('agriCV_cvs', JSON.stringify(savedCVs));
        }

        function toggleHelp(id) {
            const tooltip = document.getElementById(id);
            if (tooltip) {
                if (activeHelpTooltips.has(id)) {
                    tooltip.classList.remove('active');
                    activeHelpTooltips.delete(id);
                } else {
                    activeHelpTooltips.forEach(tid => {
                        const t = document.getElementById(tid);
                        if (t) t.classList.remove('active');
                    });
                    activeHelpTooltips.clear();
                    
                    tooltip.classList.add('active');
                    activeHelpTooltips.add(id);
                }
            }
        }

        // ========== Screen Management ==========
        function showScreen(screenId) {
            document.querySelectorAll('[id$="Screen"]').forEach(screen => {
                if (screen.id !== 'cvPreviewModal' && screen.id !== 'profileModal') {
                    screen.classList.add('hidden');
                }
            });
            document.getElementById(screenId).classList.remove('hidden');
        }

        // ========== Name Screen ==========
        document.getElementById('nameForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('userName').value.trim();
            if (name.length < 3) {
                showToast('الرجاء إدخال اسم صحيح', 'error');
                return;
            }
            userData = { name: name, createdAt: new Date().toISOString() };
            saveData();
            document.getElementById('welcomeName').textContent = `مرحباً، ${name}`;
            document.getElementById('heroGreeting').textContent = `أهلاً بك، ${name}`;
            document.getElementById('profileBtn').textContent = name.charAt(0);
            showScreen('welcomeScreen');
            showToast(`مرحباً ${name}! أهلاً بك في AgriCV`, 'success');
        });

        // ========== Welcome Screen ==========
        document.getElementById('createCVBtn').addEventListener('click', function() {
            editingCVId = null;
            resetCVData();
            currentStep = 0;
            showScreen('builderScreen');
            updateStepCounter();
            renderStepContent();
        });

        document.getElementById('myCVsBtn').addEventListener('click', function() {
            renderMyCVs();
            showScreen('myCVsScreen');
        });

        document.getElementById('profileBtn').addEventListener('click', function() {
            document.getElementById('profileName').value = userData?.name || '';
            document.getElementById('profileModal').classList.add('active');
        });

        document.getElementById('closeProfileModal').addEventListener('click', function() {
            document.getElementById('profileModal').classList.remove('active');
        });

        document.getElementById('updateProfileBtn').addEventListener('click', function() {
            const newName = document.getElementById('profileName').value.trim();
            if (newName.length < 3) {
                showToast('الرجاء إدخال اسم صحيح', 'error');
                return;
            }
            userData.name = newName;
            saveData();
            document.getElementById('welcomeName').textContent = `مرحباً، ${newName}`;
            document.getElementById('heroGreeting').textContent = `أهلاً بك، ${newName}`;
            document.getElementById('profileBtn').textContent = newName.charAt(0);
            document.getElementById('profileModal').classList.remove('active');
            showToast('تم تحديث الاسم بنجاح', 'success');
        });

        document.getElementById('deleteAccountBtn').addEventListener('click', function() {
            if (confirm('هل أنت متأكد من حذف حسابك وجميع بياناتك؟ هذا الإجراء لا يمكن التراجع عنه.')) {
                localStorage.removeItem('agriCV_user');
                localStorage.removeItem('agriCV_cvs');
                userData = null;
                savedCVs = [];
                showScreen('nameScreen');
                showToast('تم حذف الحساب بنجاح', 'success');
            }
        });

        // ========== Builder Screen ==========
        function resetCVData() {
            cvData = {
                language: 'ar',
                personal: { fullName: userData?.name || '', email: '', phone: '' },
                links: [],
                location: { country: '', city: '' },
                summary: '',
                experience: [],
                education: { university: '', faculty: 'كلية الزراعة', month: '', year: '', militaryStatus: '' },
                projects: [],
                volunteering: [],
                training: [],
                courses: [],
                certificates: [],
                skills: [],
                hasLicense: false,
                languages: [{ name: 'العربية', level: 'native' }],
                interests: []
            };
        }

        function updateStepCounter() {
            document.getElementById('currentStepNum').textContent = currentStep + 1;
            document.getElementById('totalSteps').textContent = STEPS.length;
            document.getElementById('stepTitle').textContent = STEPS[currentStep].title;
        }

        function renderStepContent() {
            const container = document.getElementById('stepContent');
            const step = STEPS[currentStep];
            
            document.getElementById('prevStepBtn').classList.toggle('hidden', currentStep === 0);
            document.getElementById('nextStepBtn').textContent = currentStep === STEPS.length - 1 ? 'إنهاء' : 'التالي';
            
            let content = '';
            
            switch(step.id) {
                case 'language': content = renderLanguageStep(); break;
                case 'personal': content = renderPersonalStep(); break;
                case 'links': content = renderLinksStep(); break;
                case 'location': content = renderLocationStep(); break;
                case 'summary': content = renderSummaryStep(); break;
                case 'experience': content = renderExperienceStep(); break;
                case 'education': content = renderEducationStep(); break;
                case 'projects': content = renderProjectsStep(); break;
                case 'volunteering': content = renderVolunteeringStep(); break;
                case 'training': content = renderTrainingStep(); break;
                case 'courses': content = renderCoursesStep(); break;
                case 'certificates': content = renderCertificatesStep(); break;
                case 'skills': content = renderSkillsStep(); break;
                case 'languages': content = renderLanguagesStep(); break;
                case 'interests': content = renderInterestsStep(); break;
                case 'preview': content = renderPreviewStep(); break;
            }
            
            container.innerHTML = `<div class="animate-fadeInUp">${content}</div>`;
            attachStepListeners();
        }

        // ========== Step Renderers ==========
        function renderLanguageStep() {
            return `
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-emerald-500/20 flex items-center justify-center">
                        <svg class="w-8 h-8 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">اختر لغة السيرة الذاتية</h2>
                    <p class="text-gray-400">حدد اللغة التي تريد إنشاء سيرتك الذاتية بها</p>
                </div>
                
                <div class="bg-amber-500/10 border border-amber-500/30 rounded-xl p-4 mb-6">
                    <div class="flex items-start gap-3">
                        <svg class="w-5 h-5 text-amber-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <div>
                            <p class="text-amber-400 font-medium text-sm">نصيحة</p>
                            <p class="text-gray-300 text-sm">إذا كنت تتقدم لوظيفة في شركة دولية أو متعددة الجنسيات، يُفضل اختيار اللغة الإنجليزية. للشركات المحلية، العربية هي الأنسب.</p>
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <label class="card cursor-pointer ${cvData.language === 'ar' ? 'border-emerald-500' : ''}">
                        <input type="radio" name="language" value="ar" class="hidden" ${cvData.language === 'ar' ? 'checked' : ''}>
                        <div class="text-center">
                            <div class="text-4xl mb-3">🇸🇦</div>
                            <h3 class="font-bold text-lg mb-1">العربية</h3>
                            <p class="text-gray-400 text-sm">سيرة ذاتية باللغة العربية</p>
                        </div>
                    </label>
                    <label class="card cursor-pointer ${cvData.language === 'en' ? 'border-emerald-500' : ''}">
                        <input type="radio" name="language" value="en" class="hidden" ${cvData.language === 'en' ? 'checked' : ''}>
                        <div class="text-center">
                            <div class="text-4xl mb-3">🇬🇧</div>
                            <h3 class="font-bold text-lg mb-1">English</h3>
                            <p class="text-gray-400 text-sm">CV in English</p>
                        </div>
                    </label>
                </div>
            `;
        }

        function renderPersonalStep() {
            const isEnglish = cvData.language === 'en';
            return `
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-blue-500/20 flex items-center justify-center">
                        <svg class="w-8 h-8 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">${isEnglish ? 'Personal Information' : 'المعلومات الشخصية'}</h2>
                    <p class="text-gray-400">${isEnglish ? 'Enter your contact details' : 'أدخل بيانات الاتصال الخاصة بك'}</p>
                </div>
                
                <div class="space-y-5">
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium text-gray-300">${isEnglish ? 'Full Name (Four parts)' : 'الاسم الرباعي'}</label>
                            <div class="help-tooltip" id="help-name">
                                <button type="button" class="help-btn" onclick="toggleHelp('help-name')">?</button>
                                <div class="help-content">
                                    <p class="text-emerald-400 font-medium mb-1">مثال:</p>
                                    <p class="text-gray-300">أحمد محمد علي حسن</p>
                                    <p class="text-gray-400 text-xs mt-2">اكتب اسمك الكامل كما سيظهر في السيرة الذاتية</p>
                                </div>
                            </div>
                        </div>
                        <input type="text" id="fullName" class="input-field" placeholder="${isEnglish ? 'Enter your full name' : 'أدخل اسمك الرباعي'}" value="${cvData.personal.fullName}">
                    </div>
                    
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium text-gray-300">${isEnglish ? 'Email Address' : 'البريد الإلكتروني'}</label>
                            <div class="help-tooltip" id="help-email">
                                <button type="button" class="help-btn" onclick="toggleHelp('help-email')">?</button>
                                <div class="help-content">
                                    <p class="text-emerald-400 font-medium mb-1">مثال:</p>
                                    <p class="text-gray-300">ahmed.hassan@gmail.com</p>
                                    <p class="text-gray-400 text-xs mt-2">استخدم بريداً احترافياً يحتوي على اسمك</p>
                                </div>
                            </div>
                        </div>
                        <input type="email" id="email" class="input-field" placeholder="${isEnglish ? 'example@email.com' : 'example@email.com'}" value="${cvData.personal.email}">
                    </div>
                    
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium text-gray-300">${isEnglish ? 'Phone Number' : 'رقم الهاتف'}</label>
                            <div class="help-tooltip" id="help-phone">
                                <button type="button" class="help-btn" onclick="toggleHelp('help-phone')">?</button>
                                <div class="help-content">
                                    <p class="text-emerald-400 font-medium mb-1">مثال:</p>
                                    <p class="text-gray-300">+20 123 456 7890</p>
                                    <p class="text-gray-400 text-xs mt-2">أضف كود الدولة للوظائف الدولية</p>
                                </div>
                            </div>
                        </div>
                        <input type="tel" id="phone" class="input-field" placeholder="+20 123 456 7890" value="${cvData.personal.phone}">
                    </div>
                </div>
            `;
        }

        function renderLinksStep() {
            const isEnglish = cvData.language === 'en';
            const linksHtml = cvData.links.map((link, index) => `
                <div class="bg-gray-800/50 rounded-xl p-4 mb-4">
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-sm text-gray-400">${isEnglish ? 'Link' : 'رابط'} ${index + 1}</span>
                        <button type="button" onclick="removeLink(${index})" class="text-red-400 hover:text-red-300 text-sm">${isEnglish ? 'Remove' : 'حذف'}</button>
                    </div>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <label class="text-xs text-gray-400">${isEnglish ? 'Link Name' : 'اسم الرابط'}</label>
                                <div class="help-tooltip" id="help-linkname${index}">
                                    <button type="button" class="help-btn text-xs" onclick="toggleHelp('help-linkname${index}')">?</button>
                                    <div class="help-content">
                                        <p class="text-emerald-400 font-medium mb-1">أمثلة:</p>
                                        <p class="text-gray-300 text-sm">LinkedIn، Portfolio، GitHub، ResearchGate</p>
                                    </div>
                                </div>
                            </div>
                            <input type="text" class="input-field link-name" placeholder="${isEnglish ? 'e.g., LinkedIn' : 'مثل: لينكد إن'}" value="${link.name}">
                        </div>
                        <div>
                            <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'URL' : 'الرابط'}</label>
                            <input type="url" class="input-field link-url" placeholder="https://..." value="${link.url}">
                        </div>
                    </div>
                </div>
            `).join('');

            return `
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-purple-500/20 flex items-center justify-center">
                        <svg class="w-8 h-8 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">${isEnglish ? 'Important Links' : 'الروابط المهمة'}</h2>
                    <p class="text-gray-400">${isEnglish ? 'Add your professional links' : 'أضف روابطك المهنية (اختياري)'}</p>
                </div>
                
                <div class="bg-purple-500/10 border border-purple-500/30 rounded-xl p-4 mb-6">
                    <div class="flex items-start gap-3">
                        <svg class="w-5 h-5 text-purple-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <div>
                            <p class="text-purple-400 font-medium text-sm">${isEnglish ? 'Why add links?' : 'لماذا تضيف روابط؟'}</p>
                            <p class="text-gray-300 text-sm">${isEnglish ? 'Adding LinkedIn profile increases your chances by 40%. Portfolio showcases your work.' : 'إضافة ملف LinkedIn يزيد فرصك بنسبة 40%. معرض الأعمال يعرض إنجازاتك.'}</p>
                        </div>
                    </div>
                </div>
                
                <div id="linksContainer">
                    ${linksHtml || `<p class="text-gray-500 text-center py-8">${isEnglish ? 'No links added yet' : 'لم يتم إضافة روابط بعد (يمكنك تخطي هذه الخطوة)'}</p>`}
                </div>
                
                <button type="button" id="addLinkBtn" class="btn-secondary w-full">
                    <svg class="inline-block w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    ${isEnglish ? 'Add Link' : 'إضافة رابط'}
                </button>
            `;
        }

        function renderLocationStep() {
            const isEnglish = cvData.language === 'en';
            return `
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-rose-500/20 flex items-center justify-center">
                        <svg class="w-8 h-8 text-rose-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">${isEnglish ? 'Location' : 'الموقع'}</h2>
                    <p class="text-gray-400">${isEnglish ? 'Where are you located?' : 'أين تقيم؟'}</p>
                </div>
                
                <div class="space-y-5">
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium text-gray-300">${isEnglish ? 'Country' : 'الدولة'}</label>
                            <div class="help-tooltip" id="help-country">
                                <button type="button" class="help-btn" onclick="toggleHelp('help-country')">?</button>
                                <div class="help-content">
                                    <p class="text-emerald-400 font-medium mb-1">مثال:</p>
                                    <p class="text-gray-300">مصر، السعودية، الإمارات</p>
                                </div>
                            </div>
                        </div>
                        <input type="text" id="country" class="input-field" placeholder="${isEnglish ? 'Enter your country' : 'أدخل دولتك'}" value="${cvData.location.country}">
                    </div>
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium text-gray-300">${isEnglish ? 'City' : 'المدينة'}</label>
                            <div class="help-tooltip" id="help-city">
                                <button type="button" class="help-btn" onclick="toggleHelp('help-city')">?</button>
                                <div class="help-content">
                                    <p class="text-emerald-400 font-medium mb-1">مثال:</p>
                                    <p class="text-gray-300">القاهرة، الرياض، دبي</p>
                                </div>
                            </div>
                        </div>
                        <input type="text" id="city" class="input-field" placeholder="${isEnglish ? 'Enter your city' : 'أدخل مدينتك'}" value="${cvData.location.city}">
                    </div>
                </div>
            `;
        }

        function renderSummaryStep() {
            const isEnglish = cvData.language === 'en';
            return `
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-cyan-500/20 flex items-center justify-center">
                        <svg class="w-8 h-8 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">${isEnglish ? 'Professional Summary' : 'الملخص المهني'}</h2>
                    <p class="text-gray-400">${isEnglish ? 'Write a brief summary about yourself' : 'اكتب ملخصاً مختصراً عن نفسك'}</p>
                </div>
                
                <div class="bg-cyan-500/10 border border-cyan-500/30 rounded-xl p-4 mb-6">
                    <div class="flex items-start gap-3">
                        <svg class="w-5 h-5 text-cyan-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <div>
                            <p class="text-cyan-400 font-medium text-sm">${isEnglish ? 'Tips for a great summary' : 'نصائح لملخص مميز'}</p>
                            <ul class="text-gray-300 text-sm list-disc list-inside mt-2 space-y-1">
                                <li>${isEnglish ? 'Keep it 3-4 sentences' : 'اجعله 3-4 جمل'}</li>
                                <li>${isEnglish ? 'Highlight your key achievements' : 'أبرز إنجازاتك الرئيسية'}</li>
                                <li>${isEnglish ? 'Mention your career goals' : 'اذكر أهدافك المهنية'}</li>
                                <li>${isEnglish ? 'Tailor it to the job' : 'خصصه للوظيفة المستهدفة'}</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-800/50 rounded-xl p-4 mb-6">
                    <p class="text-gray-400 text-sm mb-2">${isEnglish ? 'Example' : 'مثال'}:</p>
                    <p class="text-gray-300 text-sm">${isEnglish ? 'Agricultural Engineering graduate with strong background in crop management and sustainable farming practices. Passionate about applying modern agricultural technologies to improve productivity. Seeking opportunities to contribute to innovative agricultural projects.' : 'خريج هندسة زراعية مع خلفية قوية في إدارة المحاصيل والممارسات الزراعية المستدامة. شغوف بتطبيق التقنيات الزراعية الحديثة لتحسين الإنتاجية. أسعى لفرص للمساهمة في مشاريع زراعية مبتكرة.'}</p>
                </div>
                
                <div>
                    <textarea id="summary" class="input-field min-h-[150px]" placeholder="${isEnglish ? 'Write your professional summary here...' : 'اكتب ملخصك المهني هنا...'}">${cvData.summary}</textarea>
                    <p class="text-xs text-gray-500 mt-2"><span id="summaryCount">${cvData.summary.length}</span>/500 ${isEnglish ? 'characters' : 'حرف'}</p>
                </div>
            `;
        }

        function renderExperienceStep() {
            const isEnglish = cvData.language === 'en';
            const experienceHtml = cvData.experience.map((exp, index) => `
                <div class="bg-gray-800/50 rounded-xl p-4 mb-4">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-sm font-medium text-emerald-400">${isEnglish ? 'Experience' : 'خبرة'} ${index + 1}</span>
                        <button type="button" onclick="removeExperience(${index})" class="text-red-400 hover:text-red-300 text-sm">${isEnglish ? 'Remove' : 'حذف'}</button>
                    </div>
                    <div class="space-y-4">
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <div class="flex items-center justify-between mb-2">
                                    <label class="text-xs text-gray-400">${isEnglish ? 'Job Title' : 'المسمى الوظيفي'}</label>
                                    <div class="help-tooltip" id="help-exptitle${index}">
                                        <button type="button" class="help-btn text-xs" onclick="toggleHelp('help-exptitle${index}')">?</button>
                                        <div class="help-content">
                                            <p class="text-emerald-400 font-medium mb-1">${isEnglish ? 'Examples:' : 'أمثلة:'}</p>
                                            <p class="text-gray-300 text-sm">${isEnglish ? 'Agricultural Engineer, Farm Manager, Research Assistant' : 'مهندس زراعي، مدير مزرعة، باحث مساعد (وقاية نبات)'}</p>
                                        </div>
                                    </div>
                                </div>
                                <input type="text" class="input-field exp-title" placeholder="${isEnglish ? 'Job Title' : 'المسمى الوظيفي'}" value="${exp.title}">
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Company Name' : 'اسم الشركة'}</label>
                                <input type="text" class="input-field exp-company" placeholder="${isEnglish ? 'Company Name' : 'اسم الشركة'}" value="${exp.company}">
                            </div>
                        </div>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Start Date' : 'تاريخ البداية'}</label>
                                <input type="month" class="input-field exp-start" value="${exp.startDate}">
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'End Date' : 'تاريخ الانتهاء'}</label>
                                <input type="month" class="input-field exp-end" value="${exp.endDate}" ${exp.currentlyWorking ? 'disabled' : ''}>
                                <label class="checkbox-custom mt-2">
                                    <input type="checkbox" class="exp-current" ${exp.currentlyWorking ? 'checked' : ''} onchange="toggleCurrentlyWorking(${index}, this.checked)">
                                    <span class="checkmark">
                                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                                        </svg>
                                    </span>
                                    <span class="text-sm text-gray-300">${isEnglish ? 'Currently working here' : 'لا أزال أعمل هنا'}</span>
                                </label>
                            </div>
                        </div>
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <label class="text-xs text-gray-400">${isEnglish ? 'Description' : 'الوصف'}</label>
                                <div class="help-tooltip" id="help-expdesc${index}">
                                    <button type="button" class="help-btn text-xs" onclick="toggleHelp('help-expdesc${index}')">?</button>
                                    <div class="help-content">
                                        <p class="text-emerald-400 font-medium mb-1">${isEnglish ? 'What to include:' : 'ماذا تتضمن:'}</p>
                                        <p class="text-gray-300 text-sm">${isEnglish ? '- Main responsibilities\n- Key achievements\n- Technologies used' : '- المهام الرئيسية\n- الإنجازات الرئيسية\n- التقنيات المستخدمة'}</p>
                                    </div>
                                </div>
                            </div>
                            <textarea class="input-field exp-desc min-h-[100px]" placeholder="${isEnglish ? 'Describe your responsibilities and achievements...' : 'صف مسؤولياتك وإنجازاتك...'}">${exp.description}</textarea>
                        </div>
                    </div>
                </div>
            `).join('');

            return `
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-amber-500/20 flex items-center justify-center">
                        <svg class="w-8 h-8 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">${isEnglish ? 'Work Experience' : 'الخبرات العملية'}</h2>
                    <p class="text-gray-400">${isEnglish ? 'Add your work experience' : 'أضف خبراتك العملية (اختياري)'}</p>
                </div>
                
                <div class="bg-amber-500/10 border border-amber-500/30 rounded-xl p-4 mb-6">
                    <div class="flex items-start gap-3">
                        <svg class="w-5 h-5 text-amber-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <div>
                            <p class="text-amber-400 font-medium text-sm">${isEnglish ? 'Fresh graduate?' : 'خريج جديد؟'}</p>
                            <p class="text-gray-300 text-sm">${isEnglish ? 'You can add internships, volunteer work, university projects, or part-time jobs.' : 'يمكنك إضافة التدريبات أو العمل التطوعي أو مشاريع الجامعة أو العمل الجزئي.'}</p>
                        </div>
                    </div>
                </div>
                
                <div id="experienceContainer">
                    ${experienceHtml || `<p class="text-gray-500 text-center py-8">${isEnglish ? 'No experience added yet' : 'لم يتم إضافة خبرات بعد (يمكنك تخطي هذه الخطوة)'}</p>`}
                </div>
                
                <button type="button" id="addExperienceBtn" class="btn-secondary w-full">
                    <svg class="inline-block w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    ${isEnglish ? 'Add Experience' : 'إضافة خبرة'}
                </button>
            `;
        }

        function renderEducationStep() {
            const isEnglish = cvData.language === 'en';
            return `
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-indigo-500/20 flex items-center justify-center">
                        <svg class="w-8 h-8 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path d="M12 14l9-5-9-5-9 5 9 5z"></path>
                            <path d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">${isEnglish ? 'Education' : 'التعليم'}</h2>
                    <p class="text-gray-400">${isEnglish ? 'Add your educational background' : 'أضف خلفيتك التعليمية'}</p>
                </div>
                
                <div class="space-y-5">
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium text-gray-300">${isEnglish ? 'University Name' : 'اسم الجامعة'}</label>
                            <div class="help-tooltip" id="help-uni">
                                <button type="button" class="help-btn" onclick="toggleHelp('help-uni')">?</button>
                                <div class="help-content">
                                    <p class="text-emerald-400 font-medium mb-1">${isEnglish ? 'Examples:' : 'أمثلة:'}</p>
                                    <p class="text-gray-300 text-sm">${isEnglish ? 'Mansoura University, Cairo University' : 'جامعة المنصورة، جامعة القاهرة'}</p>
                                </div>
                            </div>
                        </div>
                        <input type="text" id="university" class="input-field" placeholder="${isEnglish ? 'e.g., Mansoura University' : 'مثال: جامعة المنصورة'}" value="${cvData.education.university}">
                    </div>
                    
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium text-gray-300">${isEnglish ? 'Faculty' : 'الكلية'}</label>
                            <div class="help-tooltip" id="help-faculty">
                                <button type="button" class="help-btn" onclick="toggleHelp('help-faculty')">?</button>
                                <div class="help-content">
                                    <p class="text-emerald-400 font-medium mb-1">${isEnglish ? 'Examples:' : 'أمثلة:'}</p>
                                    <p class="text-gray-300 text-sm">${isEnglish ? 'Faculty of Agriculture, Plant Protection Dept' : 'كلية الزراعة - قسم وقاية نبات، كلية الهندسة الزراعية'}</p>
                                </div>
                            </div>
                        </div>
                        <input type="text" id="faculty" class="input-field" placeholder="${isEnglish ? 'e.g., Faculty of Agriculture' : 'مثال: كلية الزراعة - قسم وقاية نبات'}" value="${cvData.education.faculty}">
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="text-sm font-medium text-gray-300 block mb-2">${isEnglish ? 'Graduation Month' : 'شهر التخرج'}</label>
                            <select id="gradMonth" class="input-field">
                                <option value="">${isEnglish ? 'Select month' : 'اختر الشهر'}</option>
                                ${['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12'].map(m => `<option value="${m}" ${cvData.education.month === m ? 'selected' : ''}>${m}</option>`).join('')}
                            </select>
                        </div>
                        <div>
                            <label class="text-sm font-medium text-gray-300 block mb-2">${isEnglish ? 'Graduation Year' : 'سنة التخرج'}</label>
                            <input type="number" id="gradYear" class="input-field" placeholder="2024" min="1990" max="2030" value="${cvData.education.year}">
                        </div>
                    </div>
                    
                    <div>
                        <div class="flex items-center justify-between mb-2">
                            <label class="text-sm font-medium text-gray-300">${isEnglish ? 'Military Status' : 'الموقف من التجنيد'}</label>
                            <div class="help-tooltip" id="help-military">
                                <button type="button" class="help-btn" onclick="toggleHelp('help-military')">?</button>
                                <div class="help-content">
                                    <p class="text-emerald-400 font-medium mb-1">${isEnglish ? 'Options:' : 'الخيارات:'}</p>
                                    <p class="text-gray-300 text-sm">${isEnglish ? 'Completed, Exempted, Postponed, Not required (for females)' : 'أديت الخدمة، معاف، مؤجل، غير مطالب (للإناث)'}</p>
                                </div>
                            </div>
                        </div>
                        <select id="militaryStatus" class="input-field">
                            <option value="">${isEnglish ? 'Select status' : 'اختر الموقف'}</option>
                            <option value="completed" ${cvData.education.militaryStatus === 'completed' ? 'selected' : ''}>${isEnglish ? 'Completed' : 'أديت الخدمة'}</option>
                            <option value="exempted" ${cvData.education.militaryStatus === 'exempted' ? 'selected' : ''}>${isEnglish ? 'Exempted' : 'معاف'}</option>
                            <option value="postponed" ${cvData.education.militaryStatus === 'postponed' ? 'selected' : ''}>${isEnglish ? 'Postponed' : 'مؤجل'}</option>
                            <option value="not_required" ${cvData.education.militaryStatus === 'not_required' ? 'selected' : ''}>${isEnglish ? 'Not required' : 'غير مطالب'}</option>
                        </select>
                    </div>
                </div>
            `;
        }

        function renderProjectsStep() {
            const isEnglish = cvData.language === 'en';
            const projectsHtml = cvData.projects.map((p, index) => `
                <div class="bg-gray-800/50 rounded-xl p-4 mb-4">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-sm font-medium text-violet-400">${isEnglish ? 'Project' : 'مشروع'} ${index + 1}</span>
                        <button type="button" onclick="removeProject(${index})" class="text-red-400 hover:text-red-300 text-sm">${isEnglish ? 'Remove' : 'حذف'}</button>
                    </div>
                    <div class="space-y-4">
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Project Name' : 'اسم المشروع'}</label>
                                <input type="text" class="input-field proj-name" placeholder="${isEnglish ? 'e.g., Automatic Irrigation System' : 'مثال: تصميم نظام ري أوتوماتيكي'}" value="${p.name}">
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Date' : 'التاريخ'}</label>
                                <input type="text" class="input-field proj-date" placeholder="${isEnglish ? 'e.g., 2023' : 'مثال: 2023'}" value="${p.date}">
                            </div>
                        </div>
                        <div>
                            <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Goal - What problem were you solving?' : 'الهدف - ما المشكلة التي كنت تحاول حلها؟'}</label>
                            <textarea class="input-field proj-goal min-h-[60px]" placeholder="${isEnglish ? 'Describe the project goal...' : 'صف هدف المشروع...'}">${p.goal}</textarea>
                        </div>
                        <div>
                            <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Your Role - What did you do exactly?' : 'دورك - ماذا فعلت بالضبط؟'}</label>
                            <textarea class="input-field proj-role min-h-[60px]" placeholder="${isEnglish ? 'Describe your role...' : 'صف دورك في المشروع...'}">${p.role}</textarea>
                        </div>
                        <div>
                            <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Tools Used - Software, equipment, technologies' : 'الأدوات المستخدمة - البرامج، الأجهزة، التقنيات'}</label>
                            <input type="text" class="input-field proj-tools" placeholder="${isEnglish ? 'e.g., Arduino, MATLAB, AutoCAD' : 'مثال: Arduino، MATLAB، AutoCAD'}" value="${p.tools}">
                        </div>
                        <div>
                            <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Result - What was the outcome?' : 'النتيجة - ماذا حدث في النهاية؟'}</label>
                            <textarea class="input-field proj-result min-h-[60px]" placeholder="${isEnglish ? 'e.g., Got excellent grade, reduced water consumption by 20%' : 'مثال: حصلت على امتياز، قللت استهلاك المياه بنسبة 20%'}">${p.result}</textarea>
                        </div>
                    </div>
                </div>
            `).join('');

            return `
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-violet-500/20 flex items-center justify-center">
                        <svg class="w-8 h-8 text-violet-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">${isEnglish ? 'Projects' : 'المشاريع'}</h2>
                    <p class="text-gray-400">${isEnglish ? 'Add university projects (graduation project, major courses)' : 'أضف مشاريع الجامعة (مشروع التخرج، مشاريع المواد الرئيسية)'}</p>
                </div>
                
                <div class="bg-violet-500/10 border border-violet-500/30 rounded-xl p-4 mb-6">
                    <div class="flex items-start gap-3">
                        <svg class="w-5 h-5 text-violet-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <div>
                            <p class="text-violet-400 font-medium text-sm">${isEnglish ? 'What to include?' : 'ماذا تتضمن؟'}</p>
                            <p class="text-gray-300 text-sm">${isEnglish ? 'Graduation project, major course projects, research projects, competitions' : 'مشروع التخرج، مشاريع المواد الرئيسية، مشاريع البحث، المسابقات'}</p>
                        </div>
                    </div>
                </div>
                
                <div id="projectsContainer">
                    ${projectsHtml || `<p class="text-gray-500 text-center py-8">${isEnglish ? 'No projects added yet' : 'لم يتم إضافة مشاريع بعد (يمكنك تخطي هذه الخطوة)'}</p>`}
                </div>
                
                <button type="button" id="addProjectBtn" class="btn-secondary w-full">
                    <svg class="inline-block w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    ${isEnglish ? 'Add Project' : 'إضافة مشروع'}
                </button>
            `;
        }

        function renderVolunteeringStep() {
            const isEnglish = cvData.language === 'en';
            const volunteeringHtml = cvData.volunteering.map((v, index) => `
                <div class="bg-gray-800/50 rounded-xl p-4 mb-4">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-sm font-medium text-pink-400">${isEnglish ? 'Volunteering' : 'تطوع'} ${index + 1}</span>
                        <button type="button" onclick="removeVolunteering(${index})" class="text-red-400 hover:text-red-300 text-sm">${isEnglish ? 'Remove' : 'حذف'}</button>
                    </div>
                    <div class="space-y-4">
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Volunteering Name' : 'اسم التطوع'}</label>
                                <input type="text" class="input-field vol-name" placeholder="${isEnglish ? 'e.g., Environmental Awareness Campaign' : 'مثال: حملة التوعية البيئية'}" value="${v.name}">
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Organization' : 'جهة التطوع'}</label>
                                <input type="text" class="input-field vol-org" placeholder="${isEnglish ? 'e.g., Red Crescent' : 'مثال: الهلال الأحمر'}" value="${v.organization}">
                            </div>
                        </div>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Start Date' : 'تاريخ البداية'}</label>
                                <input type="month" class="input-field vol-start" value="${v.startDate}">
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'End Date' : 'تاريخ النهاية'}</label>
                                <input type="month" class="input-field vol-end" value="${v.endDate}">
                            </div>
                        </div>
                        <div>
                            <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Tasks & Skills Gained' : 'المهام والمهارات المكتسبة'}</label>
                            <textarea class="input-field vol-tasks min-h-[100px]" placeholder="${isEnglish ? 'Describe your tasks and skills gained...' : 'صف المهام والمهارات التي اكتسبتها...'}">${v.tasks}</textarea>
                        </div>
                    </div>
                </div>
            `).join('');

            return `
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-pink-500/20 flex items-center justify-center">
                        <svg class="w-8 h-8 text-pink-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">${isEnglish ? 'Volunteering' : 'التطوع'}</h2>
                    <p class="text-gray-400">${isEnglish ? 'Add your volunteering experiences (optional)' : 'أضف خبراتك التطوعية (اختياري)'}</p>
                </div>
                
                <div class="bg-pink-500/10 border border-pink-500/30 rounded-xl p-4 mb-6">
                    <div class="flex items-start gap-3">
                        <svg class="w-5 h-5 text-pink-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <div>
                            <p class="text-pink-400 font-medium text-sm">${isEnglish ? 'Why add volunteering?' : 'لماذا تضيف التطوع؟'}</p>
                            <p class="text-gray-300 text-sm">${isEnglish ? 'Volunteering shows your character, develops soft skills, and demonstrates your commitment to community.' : 'التطوع يظهر شخصيتك، يطور المهارات الناعمة، ويظهر التزامك تجاه المجتمع.'}</p>
                        </div>
                    </div>
                </div>
                
                <div id="volunteeringContainer">
                    ${volunteeringHtml || `<p class="text-gray-500 text-center py-8">${isEnglish ? 'No volunteering added yet' : 'لم يتم إضافة تطوع بعد (يمكنك تخطي هذه الخطوة)'}</p>`}
                </div>
                
                <button type="button" id="addVolunteeringBtn" class="btn-secondary w-full">
                    <svg class="inline-block w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    ${isEnglish ? 'Add Volunteering' : 'إضافة تطوع'}
                </button>
            `;
        }

        function renderTrainingStep() {
            const isEnglish = cvData.language === 'en';
            const trainingHtml = cvData.training.map((t, index) => `
                <div class="bg-gray-800/50 rounded-xl p-4 mb-4">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-sm font-medium text-teal-400">${isEnglish ? 'Training' : 'تدريب'} ${index + 1}</span>
                        <button type="button" onclick="removeTraining(${index})" class="text-red-400 hover:text-red-300 text-sm">${isEnglish ? 'Remove' : 'حذف'}</button>
                    </div>
                    <div class="space-y-4">
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <div class="flex items-center justify-between mb-2">
                                    <label class="text-xs text-gray-400">${isEnglish ? 'Training Name' : 'اسم التدريب'}</label>
                                    <div class="help-tooltip" id="help-trainname${index}">
                                        <button type="button" class="help-btn text-xs" onclick="toggleHelp('help-trainname${index}')">?</button>
                                        <div class="help-content">
                                            <p class="text-emerald-400 font-medium mb-1">${isEnglish ? 'Examples:' : 'أمثلة:'}</p>
                                            <p class="text-gray-300 text-sm">${isEnglish ? 'Modern Irrigation, Plant Pathology' : 'أنظمة الري الحديثة، تشخيص أمراض النبات، وقاية نبات'}</p>
                                        </div>
                                    </div>
                                </div>
                                <input type="text" class="input-field train-name" placeholder="${isEnglish ? 'Training name' : 'اسم التدريب'}" value="${t.name}">
                            </div>
                            <div>
                                <div class="flex items-center justify-between mb-2">
                                    <label class="text-xs text-gray-400">${isEnglish ? 'Provider' : 'الجهة المنظمة'}</label>
                                    <div class="help-tooltip" id="help-trainprov${index}">
                                        <button type="button" class="help-btn text-xs" onclick="toggleHelp('help-trainprov${index}')">?</button>
                                        <div class="help-content">
                                            <p class="text-emerald-400 font-medium mb-1">${isEnglish ? 'Examples:' : 'أمثلة:'}</p>
                                            <p class="text-gray-300 text-sm">${isEnglish ? 'Academy: ABC Training Academy\nUniversity: Mansoura University' : 'أكاديمية: أكاديمية التدريب الزراعي\nجامعة: جامعة المنصورة'}</p>
                                        </div>
                                    </div>
                                </div>
                                <input type="text" class="input-field train-provider" placeholder="${isEnglish ? 'e.g., Coursera, University' : 'مثل: كورسيرا، جامعة المنصورة'}" value="${t.provider}">
                            </div>
                        </div>
                        <div class="grid md:grid-cols-3 gap-4">
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Month' : 'الشهر'}</label>
                                <select class="input-field train-month">
                                    <option value="">${isEnglish ? 'Select' : 'اختر'}</option>
                                    ${['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12'].map(m => `<option value="${m}" ${t.month === m ? 'selected' : ''}>${m}</option>`).join('')}
                                </select>
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Year' : 'السنة'}</label>
                                <input type="number" class="input-field train-year" placeholder="2024" value="${t.year}">
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Duration (hours)' : 'المدة (ساعات)'}</label>
                                <input type="number" class="input-field train-duration" placeholder="${isEnglish ? 'Hours' : 'ساعات'}" value="${t.duration}">
                            </div>
                        </div>
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <label class="text-xs text-gray-400">${isEnglish ? 'What did you learn?' : 'ماذا تعلمت؟'}</label>
                                <div class="help-tooltip" id="help-trainlearn${index}">
                                    <button type="button" class="help-btn text-xs" onclick="toggleHelp('help-trainlearn${index}')">?</button>
                                    <div class="help-content">
                                        <p class="text-emerald-400 font-medium mb-1">${isEnglish ? 'Example:' : 'مثال:'}</p>
                                        <p class="text-gray-300 text-sm">${isEnglish ? 'Gained skills in drip irrigation design.' : 'اكتساب مهارات مكافحة الآفات وتشخيص الأمراض.'}</p>
                                    </div>
                                </div>
                            </div>
                            <textarea class="input-field train-learned min-h-[80px]" placeholder="${isEnglish ? 'Skills gained, projects completed...' : 'المهارات المكتسبة، المشاريع المنجزة...'}" maxlength="200">${t.learned}</textarea>
                            <p class="text-xs text-gray-500 mt-1">${isEnglish ? 'Max 2 lines' : 'حد أقصى سطرين'}</p>
                        </div>
                    </div>
                </div>
            `).join('');

            return `
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-teal-500/20 flex items-center justify-center">
                        <svg class="w-8 h-8 text-teal-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">${isEnglish ? 'Training Programs' : 'البرامج التدريبية'}</h2>
                    <p class="text-gray-400">${isEnglish ? 'Add your training experiences' : 'أضف خبراتك التدريبية (اختياري)'}</p>
                </div>
                
                <div id="trainingContainer">
                    ${trainingHtml || `<p class="text-gray-500 text-center py-8">${isEnglish ? 'No training added yet' : 'لم يتم إضافة تدريبات بعد (يمكنك تخطي هذه الخطوة)'}</p>`}
                </div>
                
                <button type="button" id="addTrainingBtn" class="btn-secondary w-full">
                    <svg class="inline-block w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    ${isEnglish ? 'Add Training' : 'إضافة تدريب'}
                </button>
            `;
        }

        function renderCoursesStep() {
            const isEnglish = cvData.language === 'en';
            const coursesHtml = cvData.courses.map((c, index) => `
                <div class="bg-gray-800/50 rounded-xl p-4 mb-4">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-sm font-medium text-orange-400">${isEnglish ? 'Course' : 'كورس'} ${index + 1}</span>
                        <button type="button" onclick="removeCourse(${index})" class="text-red-400 hover:text-red-300 text-sm">${isEnglish ? 'Remove' : 'حذف'}</button>
                    </div>
                    <div class="space-y-4">
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <div class="flex items-center justify-between mb-2">
                                    <label class="text-xs text-gray-400">${isEnglish ? 'Course Name' : 'اسم الكورس'}</label>
                                    <div class="help-tooltip" id="help-coursename${index}">
                                        <button type="button" class="help-btn text-xs" onclick="toggleHelp('help-coursename${index}')">?</button>
                                        <div class="help-content">
                                            <p class="text-emerald-400 font-medium mb-1">${isEnglish ? 'Examples:' : 'أمثلة:'}</p>
                                            <p class="text-gray-300 text-sm">${isEnglish ? 'Introduction to Agriculture, Plant Pathology' : 'مقدمة في الزراعة، أمراض النبات، وقاية نبات'}</p>
                                        </div>
                                    </div>
                                </div>
                                <input type="text" class="input-field course-name" placeholder="${isEnglish ? 'Course name' : 'اسم الكورس'}" value="${c.name}">
                            </div>
                            <div>
                                <div class="flex items-center justify-between mb-2">
                                    <label class="text-xs text-gray-400">${isEnglish ? 'Provider' : 'مقدم الكورس'}</label>
                                    <div class="help-tooltip" id="help-courseprov${index}">
                                        <button type="button" class="help-btn text-xs" onclick="toggleHelp('help-courseprov${index}')">?</button>
                                        <div class="help-content">
                                            <p class="text-emerald-400 font-medium mb-1">${isEnglish ? 'Examples:' : 'أمثلة:'}</p>
                                            <p class="text-gray-300 text-sm">${isEnglish ? 'Coursera, Udemy, edX' : 'كورسيرا، يوديمي، منصة روافد'}</p>
                                        </div>
                                    </div>
                                </div>
                                <input type="text" class="input-field course-provider" placeholder="${isEnglish ? 'e.g., Coursera' : 'مثل: كورسيرا'}" value="${c.provider}">
                            </div>
                        </div>
                        <div class="grid md:grid-cols-3 gap-4">
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Month' : 'الشهر'}</label>
                                <select class="input-field course-month">
                                    <option value="">${isEnglish ? 'Select' : 'اختر'}</option>
                                    ${['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12'].map(m => `<option value="${m}" ${c.month === m ? 'selected' : ''}>${m}</option>`).join('')}
                                </select>
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Year' : 'السنة'}</label>
                                <input type="number" class="input-field course-year" placeholder="2024" value="${c.year}">
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Duration (hours)' : 'المدة (ساعات)'}</label>
                                <input type="number" class="input-field course-duration" placeholder="${isEnglish ? 'Hours' : 'ساعات'}" value="${c.duration}">
                            </div>
                        </div>
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <label class="text-xs text-gray-400">${isEnglish ? 'What did you learn?' : 'ماذا تعلمت؟'}</label>
                            </div>
                            <textarea class="input-field course-learned min-h-[80px]" placeholder="${isEnglish ? 'Skills gained...' : 'المهارات المكتسبة...'}" maxlength="200">${c.learned}</textarea>
                        </div>
                    </div>
                </div>
            `).join('');

            return `
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-orange-500/20 flex items-center justify-center">
                        <svg class="w-8 h-8 text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">${isEnglish ? 'Online Courses' : 'الكورسات الإلكترونية'}</h2>
                    <p class="text-gray-400">${isEnglish ? 'Add online courses you completed' : 'أضف الكورسات الإلكترونية التي أتممتها (اختياري)'}</p>
                </div>
                
                <div id="coursesContainer">
                    ${coursesHtml || `<p class="text-gray-500 text-center py-8">${isEnglish ? 'No courses added yet' : 'لم يتم إضافة كورسات بعد (يمكنك تخطي هذه الخطوة)'}</p>`}
                </div>
                
                <button type="button" id="addCourseBtn" class="btn-secondary w-full">
                    <svg class="inline-block w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    ${isEnglish ? 'Add Course' : 'إضافة كورس'}
                </button>
            `;
        }

        function renderCertificatesStep() {
            const isEnglish = cvData.language === 'en';
            const certsHtml = cvData.certificates.map((c, index) => `
                <div class="bg-gray-800/50 rounded-xl p-4 mb-4">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-sm font-medium text-yellow-400">${isEnglish ? 'Certificate' : 'شهادة'} ${index + 1}</span>
                        <button type="button" onclick="removeCertificate(${index})" class="text-red-400 hover:text-red-300 text-sm">${isEnglish ? 'Remove' : 'حذف'}</button>
                    </div>
                    <div class="space-y-4">
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Certificate Name' : 'اسم الشهادة'}</label>
                                <input type="text" class="input-field cert-name" placeholder="${isEnglish ? 'Certificate name' : 'اسم الشهادة'}" value="${c.name}">
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Issuing Organization' : 'الجهة المانحة'}</label>
                                <input type="text" class="input-field cert-issuer" placeholder="${isEnglish ? 'e.g., PMI' : 'مثل: وزارة الزراعة'}" value="${c.issuer}">
                            </div>
                        </div>
                        <div class="grid md:grid-cols-3 gap-4">
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Month' : 'الشهر'}</label>
                                <select class="input-field cert-month">
                                    <option value="">${isEnglish ? 'Select' : 'اختر'}</option>
                                    ${['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12'].map(m => `<option value="${m}" ${c.month === m ? 'selected' : ''}>${m}</option>`).join('')}
                                </select>
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Year' : 'السنة'}</label>
                                <input type="number" class="input-field cert-year" placeholder="2024" value="${c.year}">
                            </div>
                            <div>
                                <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Certificate ID' : 'رقم الاعتماد'}</label>
                                <input type="text" class="input-field cert-id" placeholder="${isEnglish ? 'Optional' : 'اختياري'}" value="${c.certificateId || ''}">
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');

            return `
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-yellow-500/20 flex items-center justify-center">
                        <svg class="w-8 h-8 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">${isEnglish ? 'Certificates' : 'الشهادات المهنية'}</h2>
                    <p class="text-gray-400">${isEnglish ? 'Add your professional certificates' : 'أضف شهاداتك المهنية (اختياري)'}</p>
                </div>
                
                <div id="certificatesContainer">
                    ${certsHtml || `<p class="text-gray-500 text-center py-8">${isEnglish ? 'No certificates added yet' : 'لم يتم إضافة شهادات بعد (يمكنك تخطي هذه الخطوة)'}</p>`}
                </div>
                
                <button type="button" id="addCertificateBtn" class="btn-secondary w-full">
                    <svg class="inline-block w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    ${isEnglish ? 'Add Certificate' : 'إضافة شهادة'}
                </button>
            `;
        }

        function renderSkillsStep() {
            const isEnglish = cvData.language === 'en';
            const skillsHtml = cvData.skills.map((s, index) => `
                <div class="bg-gray-800/50 rounded-xl p-3 flex items-center justify-between mb-2">
                    <span>${s}</span>
                    <button type="button" onclick="removeSkill(${index})" class="text-red-400 hover:text-red-300">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            `).join('');

            const suggestedSkills = isEnglish ? [
                'Crop Management', 'Soil Analysis', 'Irrigation Systems', 'Pest Control',
                'Plant Pathology', 'Agricultural Research', 'GIS', 'Data Analysis', 
                'Project Management', 'Microsoft Office', 'Team Leadership', 'Communication'
            ] : [
                'إدارة المحاصيل', 'تحليل التربة', 'أنظمة الري', 'مكافحة الآفات',
                'وقاية نبات', 'تشخيص أمراض النبات', 'البحث الزراعي', 'نظم المعلومات الجغرافية', 
                'تحليل البيانات', 'إدارة المشاريع', 'مايكروسوفت أوفيس', 'قيادة الفرق'
            ];

            return `
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-green-500/20 flex items-center justify-center">
                        <svg class="w-8 h-8 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">${isEnglish ? 'Skills' : 'المهارات'}</h2>
                    <p class="text-gray-400">${isEnglish ? 'Add your professional skills' : 'أضف مهاراتك المهنية'}</p>
                </div>
                
                <div class="mb-6">
                    <div class="flex items-center justify-between mb-2">
                        <label class="text-sm font-medium text-gray-300">${isEnglish ? 'Add a skill' : 'أضف مهارة'}</label>
                    </div>
                    <div class="flex gap-2">
                        <input type="text" id="skillInput" class="input-field flex-1" placeholder="${isEnglish ? 'Enter a skill' : 'أدخل مهارة'}">
                        <button type="button" id="addSkillBtn" class="btn-primary px-6">${isEnglish ? 'Add' : 'إضافة'}</button>
                    </div>
                </div>
                
                <div id="skillsContainer" class="mb-6">
                    ${skillsHtml || `<p class="text-gray-500 text-center py-4">${isEnglish ? 'No skills added yet' : 'لم يتم إضافة مهارات بعد'}</p>`}
                </div>
                
                <div class="mb-6">
                    <p class="text-sm text-gray-400 mb-3">${isEnglish ? 'Suggested skills for agriculture graduates:' : 'مهارات مقترحة لخريجي الزراعة:'}</p>
                    <div class="flex flex-wrap gap-2">
                        ${suggestedSkills.map(skill => `
                            <button type="button" onclick="addSuggestedSkill('${skill}')" class="px-3 py-1.5 rounded-lg bg-gray-800 hover:bg-emerald-600/20 hover:text-emerald-400 text-sm transition-colors ${cvData.skills.includes(skill) ? 'bg-emerald-600/20 text-emerald-400' : ''}">${skill}</button>
                        `).join('')}
                    </div>
                </div>
                
                <div class="bg-gray-800/30 rounded-xl p-4">
                    <div class="flex items-center justify-between mb-3">
                        <label class="text-sm font-medium text-gray-300">${isEnglish ? 'Do you have a driving license?' : 'هل تملك رخصة قيادة؟'}</label>
                    </div>
                    <div class="flex gap-4">
                        <label class="checkbox-custom">
                            <input type="radio" name="hasLicense" value="yes" ${cvData.hasLicense ? 'checked' : ''} onchange="cvData.hasLicense = true;">
                            <span class="checkmark">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </span>
                            <span class="text-sm text-gray-300">${isEnglish ? 'Yes' : 'نعم'}</span>
                        </label>
                        <label class="checkbox-custom">
                            <input type="radio" name="hasLicense" value="no" ${!cvData.hasLicense ? 'checked' : ''} onchange="cvData.hasLicense = false;">
                            <span class="checkmark">
                                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"></path>
                                </svg>
                            </span>
                            <span class="text-sm text-gray-300">${isEnglish ? 'No' : 'لا'}</span>
                        </label>
                    </div>
                </div>
            `;
        }

        function renderLanguagesStep() {
            const isEnglish = cvData.language === 'en';
            const levelLabels = {
                'native': isEnglish ? 'Native' : 'اللغة الأم',
                'fluent': isEnglish ? 'Fluent' : 'طلاقة',
                'advanced': isEnglish ? 'Advanced' : 'متقدم',
                'intermediate': isEnglish ? 'Intermediate' : 'متوسط',
                'basic': isEnglish ? 'Basic' : 'مبتدئ'
            };

            const languagesHtml = cvData.languages.map((lang, index) => `
                <div class="bg-gray-800/50 rounded-xl p-4 mb-4">
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-sm font-medium text-sky-400">${isEnglish ? 'Language' : 'لغة'} ${index + 1}</span>
                        ${index > 0 ? `<button type="button" onclick="removeLanguage(${index})" class="text-red-400 hover:text-red-300 text-sm">${isEnglish ? 'Remove' : 'حذف'}</button>` : ''}
                    </div>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Language Name' : 'اسم اللغة'}</label>
                            <input type="text" class="input-field lang-name" value="${lang.name}" ${index === 0 ? 'readonly' : ''}>
                        </div>
                        <div>
                            <label class="text-xs text-gray-400 block mb-2">${isEnglish ? 'Level' : 'المستوى'}</label>
                            <select class="input-field lang-level">
                                <option value="native" ${lang.level === 'native' ? 'selected' : ''}>${levelLabels['native']}</option>
                                <option value="fluent" ${lang.level === 'fluent' ? 'selected' : ''}>${levelLabels['fluent']}</option>
                                <option value="advanced" ${lang.level === 'advanced' ? 'selected' : ''}>${levelLabels['advanced']}</option>
                                <option value="intermediate" ${lang.level === 'intermediate' ? 'selected' : ''}>${levelLabels['intermediate']}</option>
                                <option value="basic" ${lang.level === 'basic' ? 'selected' : ''}>${levelLabels['basic']}</option>
                            </select>
                        </div>
                    </div>
                </div>
            `).join('');

            return `
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-sky-500/20 flex items-center justify-center">
                        <svg class="w-8 h-8 text-sky-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">${isEnglish ? 'Languages' : 'اللغات'}</h2>
                    <p class="text-gray-400">${isEnglish ? 'Add languages you speak' : 'أضف اللغات التي تتحدثها'}</p>
                </div>
                
                <div class="bg-sky-500/10 border border-sky-500/30 rounded-xl p-4 mb-6">
                    <div class="flex items-start gap-3">
                        <svg class="w-5 h-5 text-sky-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <div>
                            <p class="text-sky-400 font-medium text-sm">${isEnglish ? 'Note' : 'ملاحظة'}</p>
                            <p class="text-gray-300 text-sm">${isEnglish ? 'Arabic is set as your native language by default. You can add more languages below.' : 'تم تعيين العربية كلغتك الأم افتراضياً. يمكنك إضافة لغات أخرى بالأسفل.'}</p>
                        </div>
                    </div>
                </div>
                
                <div id="languagesContainer">
                    ${languagesHtml}
                </div>
                
                <button type="button" id="addLanguageBtn" class="btn-secondary w-full">
                    <svg class="inline-block w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    ${isEnglish ? 'Add Language' : 'إضافة لغة'}
                </button>
            `;
        }

        function renderInterestsStep() {
            const isEnglish = cvData.language === 'en';
            const interestsHtml = cvData.interests.map((interest, index) => `
                <div class="bg-gray-800/50 rounded-xl p-4 mb-4">
                    <div class="flex justify-between items-center">
                        <div class="flex-1">
                            <input type="text" class="input-field interest-text" placeholder="${isEnglish ? 'Enter an interest or activity' : 'أدخل اهتمام أو نشاط'}" value="${interest}">
                        </div>
                        <button type="button" onclick="removeInterest(${index})" class="text-red-400 hover:text-red-300 mr-3">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            `).join('');

            return `
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-fuchsia-500/20 flex items-center justify-center">
                        <svg class="w-8 h-8 text-fuchsia-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">${isEnglish ? 'Activities & Interests' : 'الأنشطة والاهتمامات'}</h2>
                    <p class="text-gray-400">${isEnglish ? 'Share your hobbies and activities' : 'شارك هواياتك وأنشطتك (اختياري)'}</p>
                </div>
                
                <div id="interestsContainer">
                    ${interestsHtml || `<p class="text-gray-500 text-center py-8">${isEnglish ? 'No interests added yet' : 'لم يتم إضافة اهتمامات بعد (يمكنك تخطي هذه الخطوة)'}</p>`}
                </div>
                
                <button type="button" id="addInterestBtn" class="btn-secondary w-full">
                    <svg class="inline-block w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                    ${isEnglish ? 'Add Interest' : 'إضافة اهتمام'}
                </button>
            `;
        }

        function renderPreviewStep() {
            return `
                <div class="text-center mb-8">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-emerald-500/20 flex items-center justify-center">
                        <svg class="w-8 h-8 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">تم إنشاء سيرتك الذاتية!</h2>
                    <p class="text-gray-400">راجع سيرتك الذاتية وقم بنسخها</p>
                </div>
                
                <div class="flex flex-col gap-4 mb-6">
                    <button id="previewCVBtn" class="btn-primary w-full">
                        <svg class="inline-block w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                        </svg>
                        معاينة السيرة الذاتية
                    </button>
                    <button id="saveCVBtn" class="btn-secondary w-full">
                        <svg class="inline-block w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                        </svg>
                        حفظ في سيرتي الذاتية
                    </button>
                </div>
                
                <div class="bg-gray-800/30 rounded-xl p-6 text-center">
                    <div class="flex justify-center gap-6">
                        <div class="text-center">
                            <div class="w-12 h-12 rounded-xl bg-emerald-500/20 flex items-center justify-center mb-2 mx-auto">
                                <svg class="w-6 h-6 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                </svg>
                            </div>
                            <p class="text-sm text-gray-500">متوافق ATS</p>
                        </div>
                        <div class="text-center">
                            <div class="w-12 h-12 rounded-xl bg-amber-500/20 flex items-center justify-center mb-2 mx-auto">
                                <svg class="w-6 h-6 text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                </svg>
                            </div>
                            <p class="text-sm text-gray-500">قابل للتعديل</p>
                        </div>
                        <div class="text-center">
                            <div class="w-12 h-12 rounded-xl bg-blue-500/20 flex items-center justify-center mb-2 mx-auto">
                                <svg class="w-6 h-6 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path>
                                </svg>
                            </div>
                            <p class="text-sm text-gray-500">نسخ سهل</p>
                        </div>
                    </div>
                </div>
            `;
        }

        // ========== Helper Functions ==========
        function toggleCurrentlyWorking(index, checked) {
            cvData.experience[index].currentlyWorking = checked;
            const endInput = document.querySelectorAll('.exp-end')[index];
            if (endInput) {
                endInput.disabled = checked;
                if (checked) endInput.value = '';
            }
        }

        // ========== Step Listeners ==========
        function attachStepListeners() {
            // Language step
            document.querySelectorAll('input[name="language"]').forEach(input => {
                input.addEventListener('change', function() {
                    cvData.language = this.value;
                    document.querySelectorAll('input[name="language"]').forEach(i => {
                        i.closest('label').classList.toggle('border-emerald-500', i.checked);
                    });
                });
            });

            // Personal step
            const fullName = document.getElementById('fullName');
            const email = document.getElementById('email');
            const phone = document.getElementById('phone');
            
            if (fullName) fullName.addEventListener('input', e => cvData.personal.fullName = e.target.value);
            if (email) email.addEventListener('input', e => cvData.personal.email = e.target.value);
            if (phone) phone.addEventListener('input', e => cvData.personal.phone = e.target.value);

            // Location step
            const country = document.getElementById('country');
            const city = document.getElementById('city');
            
            if (country) country.addEventListener('input', e => cvData.location.country = e.target.value);
            if (city) city.addEventListener('input', e => cvData.location.city = e.target.value);

            // Summary step
            const summary = document.getElementById('summary');
            if (summary) {
                summary.addEventListener('input', e => {
                    cvData.summary = e.target.value;
                    const count = document.getElementById('summaryCount');
                    if (count) count.textContent = e.target.value.length;
                });
            }

            // Education step
            const university = document.getElementById('university');
            const faculty = document.getElementById('faculty');
            const gradMonth = document.getElementById('gradMonth');
            const gradYear = document.getElementById('gradYear');
            const militaryStatus = document.getElementById('militaryStatus');
            
            if (university) university.addEventListener('input', e => cvData.education.university = e.target.value);
            if (faculty) faculty.addEventListener('input', e => cvData.education.faculty = e.target.value);
            if (gradMonth) gradMonth.addEventListener('change', e => cvData.education.month = e.target.value);
            if (gradYear) gradYear.addEventListener('input', e => cvData.education.year = e.target.value);
            if (militaryStatus) militaryStatus.addEventListener('change', e => cvData.education.militaryStatus = e.target.value);

            // Add buttons with data saving before adding new item
            const addLinkBtn = document.getElementById('addLinkBtn');
            if (addLinkBtn) {
                addLinkBtn.addEventListener('click', () => {
                    saveCurrentStepData();
                    cvData.links.push({ name: '', url: '' });
                    renderStepContent();
                });
            }

            const addExpBtn = document.getElementById('addExperienceBtn');
            if (addExpBtn) {
                addExpBtn.addEventListener('click', () => {
                    saveCurrentStepData();
                    cvData.experience.push({ title: '', company: '', startDate: '', endDate: '', description: '', currentlyWorking: false });
                    renderStepContent();
                });
            }

            const addProjectBtn = document.getElementById('addProjectBtn');
            if (addProjectBtn) {
                addProjectBtn.addEventListener('click', () => {
                    saveCurrentStepData();
                    cvData.projects.push({ name: '', date: '', goal: '', role: '', tools: '', result: '' });
                    renderStepContent();
                });
            }

            const addVolunteeringBtn = document.getElementById('addVolunteeringBtn');
            if (addVolunteeringBtn) {
                addVolunteeringBtn.addEventListener('click', () => {
                    saveCurrentStepData();
                    cvData.volunteering.push({ name: '', organization: '', startDate: '', endDate: '', tasks: '' });
                    renderStepContent();
                });
            }

            const addTrainBtn = document.getElementById('addTrainingBtn');
            if (addTrainBtn) {
                addTrainBtn.addEventListener('click', () => {
                    saveCurrentStepData();
                    cvData.training.push({ name: '', provider: '', month: '', year: '', duration: '', learned: '' });
                    renderStepContent();
                });
            }

            const addCourseBtn = document.getElementById('addCourseBtn');
            if (addCourseBtn) {
                addCourseBtn.addEventListener('click', () => {
                    saveCurrentStepData();
                    cvData.courses.push({ name: '', provider: '', month: '', year: '', duration: '', learned: '' });
                    renderStepContent();
                });
            }

            const addCertBtn = document.getElementById('addCertificateBtn');
            if (addCertBtn) {
                addCertBtn.addEventListener('click', () => {
                    saveCurrentStepData();
                    cvData.certificates.push({ name: '', issuer: '', month: '', year: '', certificateId: '' });
                    renderStepContent();
                });
            }

            const skillInput = document.getElementById('skillInput');
            const addSkillBtnEl = document.getElementById('addSkillBtn');
            if (addSkillBtnEl && skillInput) {
                addSkillBtnEl.addEventListener('click', () => {
                    const skill = skillInput.value.trim();
                    if (skill && !cvData.skills.includes(skill)) {
                        cvData.skills.push(skill);
                        skillInput.value = '';
                        renderStepContent();
                    }
                });
                skillInput.addEventListener('keypress', e => {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        addSkillBtnEl.click();
                    }
                });
            }

            const addLanguageBtn = document.getElementById('addLanguageBtn');
            if (addLanguageBtn) {
                addLanguageBtn.addEventListener('click', () => {
                    saveCurrentStepData();
                    cvData.languages.push({ name: '', level: 'intermediate' });
                    renderStepContent();
                });
            }

            const addInterestBtn = document.getElementById('addInterestBtn');
            if (addInterestBtn) {
                addInterestBtn.addEventListener('click', () => {
                    saveCurrentStepData();
                    cvData.interests.push('');
                    renderStepContent();
                });
            }

            // Preview step
            const previewBtn = document.getElementById('previewCVBtn');
            const saveBtn = document.getElementById('saveCVBtn');
            
            if (previewBtn) previewBtn.addEventListener('click', showCVPreview);
            if (saveBtn) saveBtn.addEventListener('click', saveCV);
        }

        // ========== Remove Functions ==========
        function removeLink(index) { cvData.links.splice(index, 1); renderStepContent(); }
        function removeExperience(index) { cvData.experience.splice(index, 1); renderStepContent(); }
        function removeProject(index) { cvData.projects.splice(index, 1); renderStepContent(); }
        function removeVolunteering(index) { cvData.volunteering.splice(index, 1); renderStepContent(); }
        function removeTraining(index) { cvData.training.splice(index, 1); renderStepContent(); }
        function removeCourse(index) { cvData.courses.splice(index, 1); renderStepContent(); }
        function removeCertificate(index) { cvData.certificates.splice(index, 1); renderStepContent(); }
        function removeSkill(index) { cvData.skills.splice(index, 1); renderStepContent(); }
        function removeLanguage(index) { cvData.languages.splice(index, 1); renderStepContent(); }
        function removeInterest(index) { cvData.interests.splice(index, 1); renderStepContent(); }
        function addSuggestedSkill(skill) { if (!cvData.skills.includes(skill)) { cvData.skills.push(skill); renderStepContent(); } }

        // ========== Navigation ==========
        document.getElementById('prevStepBtn').addEventListener('click', function() {
            if (currentStep > 0) {
                saveCurrentStepData();
                currentStep--;
                updateStepCounter();
                renderStepContent();
            }
        });

        document.getElementById('nextStepBtn').addEventListener('click', function() {
            if (validateCurrentStep()) {
                saveCurrentStepData();
                if (currentStep < STEPS.length - 1) {
                    currentStep++;
                    updateStepCounter();
                    renderStepContent();
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                } else {
                    showToast('تم إنشاء سيرتك الذاتية بنجاح!', 'success');
                }
            }
        });

        document.getElementById('backToHome').addEventListener('click', function() {
            if (confirm('هل تريد العودة؟ سيتم حفظ البيانات الحالية.')) {
                saveCurrentStepData();
                showScreen('welcomeScreen');
            }
        });

        document.getElementById('saveDraftBtn').addEventListener('click', function() {
            saveCurrentStepData();
            showToast('تم حفظ المسودة', 'success');
        });

        // ========== Fixed Save Current Step Data ==========
        function saveCurrentStepData() {
            const step = STEPS[currentStep];
            
            switch(step.id) {
                case 'links':
                    cvData.links = [];
                    document.querySelectorAll('#linksContainer > div').forEach(container => {
                        const name = container.querySelector('.link-name');
                        const url = container.querySelector('.link-url');
                        if (name && url && (name.value.trim() || url.value.trim())) {
                            cvData.links.push({ name: name.value.trim(), url: url.value.trim() });
                        }
                    });
                    break;
                    
                case 'experience':
                    cvData.experience = [];
                    document.querySelectorAll('#experienceContainer > div').forEach(container => {
                        const title = container.querySelector('.exp-title');
                        if (title) {
                            cvData.experience.push({
                                title: title.value.trim(),
                                company: container.querySelector('.exp-company')?.value.trim() || '',
                                startDate: container.querySelector('.exp-start')?.value || '',
                                endDate: container.querySelector('.exp-end')?.value || '',
                                description: container.querySelector('.exp-desc')?.value.trim() || '',
                                currentlyWorking: container.querySelector('.exp-current')?.checked || false
                            });
                        }
                    });
                    break;

                case 'projects':
                    cvData.projects = [];
                    document.querySelectorAll('#projectsContainer > div').forEach(container => {
                        const name = container.querySelector('.proj-name');
                        if (name && name.value.trim()) {
                            cvData.projects.push({
                                name: name.value.trim(),
                                date: container.querySelector('.proj-date')?.value.trim() || '',
                                goal: container.querySelector('.proj-goal')?.value.trim() || '',
                                role: container.querySelector('.proj-role')?.value.trim() || '',
                                tools: container.querySelector('.proj-tools')?.value.trim() || '',
                                result: container.querySelector('.proj-result')?.value.trim() || ''
                            });
                        }
                    });
                    break;

                case 'volunteering':
                    cvData.volunteering = [];
                    document.querySelectorAll('#volunteeringContainer > div').forEach(container => {
                        const name = container.querySelector('.vol-name');
                        if (name && name.value.trim()) {
                            cvData.volunteering.push({
                                name: name.value.trim(),
                                organization: container.querySelector('.vol-org')?.value.trim() || '',
                                startDate: container.querySelector('.vol-start')?.value || '',
                                endDate: container.querySelector('.vol-end')?.value || '',
                                tasks: container.querySelector('.vol-tasks')?.value.trim() || ''
                            });
                        }
                    });
                    break;
                    
                case 'training':
                    cvData.training = [];
                    document.querySelectorAll('#trainingContainer > div').forEach(container => {
                        const name = container.querySelector('.train-name');
                        if (name && name.value.trim()) {
                            cvData.training.push({
                                name: name.value.trim(),
                                provider: container.querySelector('.train-provider')?.value.trim() || '',
                                month: container.querySelector('.train-month')?.value || '',
                                year: container.querySelector('.train-year')?.value || '',
                                duration: container.querySelector('.train-duration')?.value || '',
                                learned: container.querySelector('.train-learned')?.value.trim() || ''
                            });
                        }
                    });
                    break;
                    
                case 'courses':
                    cvData.courses = [];
                    document.querySelectorAll('#coursesContainer > div').forEach(container => {
                        const name = container.querySelector('.course-name');
                        if (name && name.value.trim()) {
                            cvData.courses.push({
                                name: name.value.trim(),
                                provider: container.querySelector('.course-provider')?.value.trim() || '',
                                month: container.querySelector('.course-month')?.value || '',
                                year: container.querySelector('.course-year')?.value || '',
                                duration: container.querySelector('.course-duration')?.value || '',
                                learned: container.querySelector('.course-learned')?.value.trim() || ''
                            });
                        }
                    });
                    break;
                                    case 'certificates':
                    cvData.certificates = [];
                    document.querySelectorAll('#certificatesContainer > div').forEach(container => {
                        const name = container.querySelector('.cert-name');
                        if (name && name.value.trim()) {
                            cvData.certificates.push({
                                name: name.value.trim(),
                                issuer: container.querySelector('.cert-issuer')?.value.trim() || '',
                                month: container.querySelector('.cert-month')?.value || '',
                                year: container.querySelector('.cert-year')?.value || '',
                                certificateId: container.querySelector('.cert-id')?.value.trim() || ''
                            });
                        }
                    });
                    break;

                case 'languages':
                    cvData.languages = [];
                    document.querySelectorAll('#languagesContainer > div').forEach(container => {
                        const name = container.querySelector('.lang-name');
                        const level = container.querySelector('.lang-level');
                        if (name && level) {
                            cvData.languages.push({
                                name: name.value.trim(),
                                level: level.value
                            });
                        }
                    });
                    break;
                    
                case 'interests':
                    cvData.interests = [];
                    document.querySelectorAll('.interest-text').forEach(input => {
                        if (input.value.trim()) {
                            cvData.interests.push(input.value.trim());
                        }
                    });
                    break;
            }
        }

        function validateCurrentStep() {
            const step = STEPS[currentStep];
            const isEnglish = cvData.language === 'en';
            
            switch(step.id) {
                case 'personal':
                    const fullName = document.getElementById('fullName');
                    const email = document.getElementById('email');
                    const phone = document.getElementById('phone');
                    
                    if (!fullName.value.trim()) {
                        showToast(isEnglish ? 'Please enter your full name' : 'الرجاء إدخال الاسم الكامل', 'error');
                        fullName.classList.add('error');
                        return false;
                    }
                    if (!email.value.trim() || !email.value.includes('@')) {
                        showToast(isEnglish ? 'Please enter a valid email' : 'الرجاء إدخال بريد إلكتروني صحيح', 'error');
                        email.classList.add('error');
                        return false;
                    }
                    if (!phone.value.trim()) {
                        showToast(isEnglish ? 'Please enter your phone number' : 'الرجاء إدخال رقم الهاتف', 'error');
                        phone.classList.add('error');
                        return false;
                    }
                    return true;
                    
                case 'education':
                    const university = document.getElementById('university');
                    if (!university.value.trim()) {
                        showToast(isEnglish ? 'Please enter university name' : 'الرجاء إدخال اسم الجامعة', 'error');
                        university.classList.add('error');
                        return false;
                    }
                    return true;
                    
                default:
                    return true;
            }
        }

        // ========== CV Preview & Copy ==========
        function generateCVHTML() {
            const isEnglish = cvData.language === 'en';
            const dir = isEnglish ? 'ltr' : 'rtl';
            
            let linksSection = '';
            if (cvData.links.length > 0) {
                linksSection = cvData.links.filter(l => l.name && l.url).map(l => `<a href="${l.url}" style="color: #1a1a1a; text-decoration: none; border-bottom: 1px solid #059669;">${l.name}</a>`).join(' | ');
            }

            let experienceSection = '';
            if (cvData.experience.length > 0) {
                experienceSection = `
                    <div style="margin-bottom: 20px;">
                        <h3 style="color: #1a1a1a; border-bottom: 2px solid #059669; padding-bottom: 5px; margin-bottom: 15px; font-size: 16px; font-weight: 700;">${isEnglish ? 'WORK EXPERIENCE' : 'الخبرات العملية'}</h3>
                        ${cvData.experience.filter(e => e.title).map(exp => `
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <strong style="font-size: 14px;">${exp.title}</strong>
                                    <span style="color: #666; font-size: 13px;">${exp.startDate} - ${exp.currentlyWorking ? (isEnglish ? 'Present' : 'حتى الآن') : (exp.endDate || (isEnglish ? 'Present' : 'حتى الآن'))}</span>
                                </div>
                                ${exp.company ? `<div style="color: #059669; margin-bottom: 5px; font-size: 13px;">${exp.company}</div>` : ''}
                                ${exp.description ? `<p style="margin: 0; color: #444; font-size: 13px; line-height: 1.6;">${exp.description}</p>` : ''}
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            let projectsSection = '';
            if (cvData.projects.length > 0) {
                projectsSection = `
                    <div style="margin-bottom: 20px;">
                        <h3 style="color: #1a1a1a; border-bottom: 2px solid #059669; padding-bottom: 5px; margin-bottom: 15px; font-size: 16px; font-weight: 700;">${isEnglish ? 'PROJECTS' : 'المشاريع'}</h3>
                        ${cvData.projects.filter(p => p.name).map(p => `
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <strong style="font-size: 14px;">${p.name}</strong>
                                    ${p.date ? `<span style="color: #666; font-size: 13px;">${p.date}</span>` : ''}
                                </div>
                                ${p.goal ? `<p style="margin: 3px 0; color: #444; font-size: 13px;"><strong>${isEnglish ? 'Goal' : 'الهدف'}:</strong> ${p.goal}</p>` : ''}
                                ${p.role ? `<p style="margin: 3px 0; color: #444; font-size: 13px;"><strong>${isEnglish ? 'Role' : 'الدور'}:</strong> ${p.role}</p>` : ''}
                                ${p.tools ? `<p style="margin: 3px 0; color: #444; font-size: 13px;"><strong>${isEnglish ? 'Tools' : 'الأدوات'}:</strong> ${p.tools}</p>` : ''}
                                ${p.result ? `<p style="margin: 3px 0; color: #444; font-size: 13px;"><strong>${isEnglish ? 'Result' : 'النتيجة'}:</strong> ${p.result}</p>` : ''}
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            let volunteeringSection = '';
            if (cvData.volunteering.length > 0) {
                volunteeringSection = `
                    <div style="margin-bottom: 20px;">
                        <h3 style="color: #1a1a1a; border-bottom: 2px solid #059669; padding-bottom: 5px; margin-bottom: 15px; font-size: 16px; font-weight: 700;">${isEnglish ? 'VOLUNTEERING' : 'التطوع'}</h3>
                        ${cvData.volunteering.filter(v => v.name).map(v => `
                            <div style="margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                    <strong style="font-size: 14px;">${v.name}</strong>
                                    <span style="color: #666; font-size: 13px;">${v.startDate} - ${v.endDate || (isEnglish ? 'Present' : 'حتى الآن')}</span>
                                </div>
                                ${v.organization ? `<div style="color: #059669; margin-bottom: 5px; font-size: 13px;">${v.organization}</div>` : ''}
                                ${v.tasks ? `<p style="margin: 0; color: #444; font-size: 13px; line-height: 1.6;">${v.tasks}</p>` : ''}
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            let trainingSection = '';
            if (cvData.training.length > 0) {
                trainingSection = `
                    <div style="margin-bottom: 20px;">
                        <h3 style="color: #1a1a1a; border-bottom: 2px solid #059669; padding-bottom: 5px; margin-bottom: 15px; font-size: 16px; font-weight: 700;">${isEnglish ? 'TRAINING PROGRAMS' : 'البرامج التدريبية'}</h3>
                        ${cvData.training.filter(t => t.name).map(t => `
                            <div style="margin-bottom: 12px;">
                                <div style="display: flex; justify-content: space-between;">
                                    <strong style="font-size: 14px;">${t.name}</strong>
                                    <span style="color: #666; font-size: 13px;">${t.month}/${t.year}</span>
                                </div>
                                <div style="color: #059669; font-size: 13px;">${t.provider}${t.duration ? ` | ${t.duration} ${isEnglish ? 'hours' : 'ساعة'}` : ''}</div>
                                ${t.learned ? `<p style="margin: 5px 0 0 0; color: #444; font-size: 13px;">${t.learned}</p>` : ''}
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            let coursesSection = '';
            if (cvData.courses.length > 0) {
                coursesSection = `
                    <div style="margin-bottom: 20px;">
                        <h3 style="color: #1a1a1a; border-bottom: 2px solid #059669; padding-bottom: 5px; margin-bottom: 15px; font-size: 16px; font-weight: 700;">${isEnglish ? 'ONLINE COURSES' : 'الكورسات الإلكترونية'}</h3>
                        ${cvData.courses.filter(c => c.name).map(c => `
                            <div style="margin-bottom: 12px;">
                                <div style="display: flex; justify-content: space-between;">
                                    <strong style="font-size: 14px;">${c.name}</strong>
                                    <span style="color: #666; font-size: 13px;">${c.month}/${c.year}</span>
                                </div>
                                <div style="color: #059669; font-size: 13px;">${c.provider}${c.duration ? ` | ${c.duration} ${isEnglish ? 'hours' : 'ساعة'}` : ''}</div>
                                ${c.learned ? `<p style="margin: 5px 0 0 0; color: #444; font-size: 13px;">${c.learned}</p>` : ''}
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            let certificatesSection = '';
            if (cvData.certificates.length > 0) {
                certificatesSection = `
                    <div style="margin-bottom: 20px;">
                        <h3 style="color: #1a1a1a; border-bottom: 2px solid #059669; padding-bottom: 5px; margin-bottom: 15px; font-size: 16px; font-weight: 700;">${isEnglish ? 'CERTIFICATES' : 'الشهادات المهنية'}</h3>
                        ${cvData.certificates.filter(c => c.name).map(c => `
                            <div style="margin-bottom: 10px;">
                                <div style="display: flex; justify-content: space-between;">
                                    <strong style="font-size: 14px;">${c.name}</strong>
                                    <span style="color: #666; font-size: 13px;">${c.month}/${c.year}</span>
                                </div>
                                <div style="color: #059669; font-size: 13px;">${c.issuer}${c.certificateId ? ` | ${isEnglish ? 'ID' : 'رقم'}: ${c.certificateId}` : ''}</div>
                            </div>
                        `).join('')}
                    </div>
                `;
            }

            let skillsSection = '';
            if (cvData.skills.length > 0) {
                skillsSection = `
                    <div style="margin-bottom: 20px;">
                        <h3 style="color: #1a1a1a; border-bottom: 2px solid #059669; padding-bottom: 5px; margin-bottom: 15px; font-size: 16px; font-weight: 700;">${isEnglish ? 'SKILLS' : 'المهارات'}</h3>
                        <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                            ${cvData.skills.map(s => `<span style="background: #f0f0f0; color: #1a1a1a; padding: 4px 12px; border-radius: 4px; font-size: 13px; border: 1px solid #ddd;">${s}</span>`).join('')}
                        </div>
                        ${cvData.hasLicense ? `<p style="margin-top: 10px; font-size: 13px;"><strong>${isEnglish ? 'Driving License' : 'رخصة قيادة'}:</strong> ${isEnglish ? 'Yes' : 'نعم'}</p>` : ''}
                    </div>
                `;
            }

            let languagesSection = '';
            if (cvData.languages.length > 0) {
                const levelLabels = {
                    'native': isEnglish ? 'Native' : 'اللغة الأم',
                    'fluent': isEnglish ? 'Fluent' : 'طلاقة',
                    'advanced': isEnglish ? 'Advanced' : 'متقدم',
                    'intermediate': isEnglish ? 'Intermediate' : 'متوسط',
                    'basic': isEnglish ? 'Basic' : 'مبتدئ'
                };
                languagesSection = `
                    <div style="margin-bottom: 20px;">
                        <h3 style="color: #1a1a1a; border-bottom: 2px solid #059669; padding-bottom: 5px; margin-bottom: 15px; font-size: 16px; font-weight: 700;">${isEnglish ? 'LANGUAGES' : 'اللغات'}</h3>
                        ${cvData.languages.filter(l => l.name).map(l => `
                            <div style="margin-bottom: 8px; font-size: 13px;">
                                <strong>${l.name}</strong> - ${levelLabels[l.level] || l.level}
                            </div>
                        `).join('')}
                    </div>
                `;
            }
            
            let interestsSection = '';
            if (cvData.interests.length > 0) {
                const filteredInterests = cvData.interests.filter(i => i.trim());
                if (filteredInterests.length > 0) {
                    interestsSection = `
                        <div style="margin-bottom: 20px;">
                            <h3 style="color: #1a1a1a; border-bottom: 2px solid #059669; padding-bottom: 5px; margin-bottom: 15px; font-size: 16px; font-weight: 700;">${isEnglish ? 'ACTIVITIES & INTERESTS' : 'الأنشطة والاهتمامات'}</h3>
                            <p style="margin: 0; color: #444; font-size: 13px;">${filteredInterests.join(' | ')}</p>
                        </div>
                    `;
                }
            }
            
            const militaryLabels = {
                'completed': isEnglish ? 'Completed' : 'أديت الخدمة',
                'exempted': isEnglish ? 'Exempted' : 'معاف',
                'postponed': isEnglish ? 'Postponed' : 'مؤجل',
                'not_required': isEnglish ? 'Not required' : 'غير مطالب'
            };
            
            return `
                <div dir="${dir}" style="font-family: 'Segoe UI', Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 40px; background: white; color: #1a1a1a; line-height: 1.6;">
                    <!-- Header -->
                    <div style="text-align: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid #059669;">
                        <h1 style="color: #1a1a1a; margin: 0 0 15px 0; font-size: 26px; font-weight: 700;">${cvData.personal.fullName}</h1>
                        <div style="color: #666; margin-bottom: 10px; font-size: 14px;">
                            ${cvData.personal.email} | ${cvData.personal.phone}
                            ${cvData.location.city ? `<br>${cvData.location.city}${cvData.location.country ? `, ${cvData.location.country}` : ''}` : ''}
                        </div>
                        ${linksSection ? `<div style="font-size: 13px; color: #059669;">${linksSection}</div>` : ''}
                    </div>
                    
                    <!-- Summary -->
                    ${cvData.summary ? `
                        <div style="margin-bottom: 20px;">
                            <h3 style="color: #1a1a1a; border-bottom: 2px solid #059669; padding-bottom: 5px; margin-bottom: 15px; font-size: 16px; font-weight: 700;">${isEnglish ? 'PROFESSIONAL SUMMARY' : 'الملخص المهني'}</h3>
                            <p style="margin: 0; color: #444; font-size: 13px; line-height: 1.8;">${cvData.summary}</p>
                        </div>
                    ` : ''}
                    
                    <!-- Education -->
                    <div style="margin-bottom: 20px;">
                        <h3 style="color: #1a1a1a; border-bottom: 2px solid #059669; padding-bottom: 5px; margin-bottom: 15px; font-size: 16px; font-weight: 700;">${isEnglish ? 'EDUCATION' : 'التعليم'}</h3>
                        <div>
                            <strong style="font-size: 14px;">${cvData.education.faculty || (isEnglish ? 'Faculty of Agriculture' : 'كلية الزراعة')}</strong>
                            <br>
                            <span style="color: #059669; font-size: 13px;">${cvData.education.university}</span>
                            ${cvData.education.year ? `<br><span style="color: #888; font-size: 13px;">${isEnglish ? 'Graduated' : 'تخرج'}: ${cvData.education.month}/${cvData.education.year}</span>` : ''}
                            ${cvData.education.militaryStatus ? `<br><span style="color: #888; font-size: 13px;">${isEnglish ? 'Military Status' : 'الموقف من التجنيد'}: ${militaryLabels[cvData.education.militaryStatus]}</span>` : ''}
                        </div>
                    </div>
                    
                    ${experienceSection}
                    ${projectsSection}
                    ${volunteeringSection}
                    ${trainingSection}
                    ${coursesSection}
                    ${certificatesSection}
                    ${skillsSection}
                    ${languagesSection}
                    ${interestsSection}
                </div>
            `;
        }

        function generatePlainText() {
            const isEnglish = cvData.language === 'en';
            let text = '';
            
            // Header
            text += `${cvData.personal.fullName}\n`;
            text += `${'='.repeat(cvData.personal.fullName.length)}\n\n`;
            text += `${cvData.personal.email} | ${cvData.personal.phone}\n`;
            if (cvData.location.city) {
                text += `${cvData.location.city}${cvData.location.country ? `, ${cvData.location.country}` : ''}\n`;
            }
            if (cvData.links.length > 0) {
                text += cvData.links.filter(l => l.name && l.url).map(l => l.url).join(' | ') + '\n';
            }
            text += '\n';
            
            // Summary
            if (cvData.summary) {
                text += `${isEnglish ? 'PROFESSIONAL SUMMARY' : 'الملخص المهني'}\n`;
                text += '-'.repeat(30) + '\n';
                text += `${cvData.summary}\n\n`;
            }
            
            // Education
            text += `${isEnglish ? 'EDUCATION' : 'التعليم'}\n`;
            text += '-'.repeat(30) + '\n';
            text += `${cvData.education.faculty || (isEnglish ? 'Faculty of Agriculture' : 'كلية الزراعة')}\n`;
            text += `${cvData.education.university}\n`;
            if (cvData.education.year) {
                text += `${isEnglish ? 'Graduated' : 'تخرج'}: ${cvData.education.month}/${cvData.education.year}\n`;
            }
            const militaryLabels = {
                'completed': isEnglish ? 'Completed' : 'أديت الخدمة',
                'exempted': isEnglish ? 'Exempted' : 'معاف',
                'postponed': isEnglish ? 'Postponed' : 'مؤجل',
                'not_required': isEnglish ? 'Not required' : 'غير مطالب'
            };
            if (cvData.education.militaryStatus) {
                text += `${isEnglish ? 'Military Status' : 'الموقف من التجنيد'}: ${militaryLabels[cvData.education.militaryStatus]}\n`;
            }
            text += '\n';
            
            // Experience
            if (cvData.experience.length > 0) {
                text += `${isEnglish ? 'WORK EXPERIENCE' : 'الخبرات العملية'}\n`;
                text += '-'.repeat(30) + '\n';
                cvData.experience.filter(e => e.title).forEach(exp => {
                    text += `• ${exp.title}`;
                    if (exp.company) text += ` - ${exp.company}`;
                    text += '\n';
                    text += `  ${exp.startDate} - ${exp.currentlyWorking ? (isEnglish ? 'Present' : 'حتى الآن') : (exp.endDate || (isEnglish ? 'Present' : 'حتى الآن'))}\n`;
                    if (exp.description) text += `  ${exp.description}\n`;
                    text += '\n';
                });
            }

            // Projects
            if (cvData.projects.length > 0) {
                text += `${isEnglish ? 'PROJECTS' : 'المشاريع'}\n`;
                text += '-'.repeat(30) + '\n';
                cvData.projects.filter(p => p.name).forEach(p => {
                    text += `• ${p.name}`;
                    if (p.date) text += ` (${p.date})`;
                    text += '\n';
                    if (p.goal) text += `  ${isEnglish ? 'Goal' : 'الهدف'}: ${p.goal}\n`;
                    if (p.role) text += `  ${isEnglish ? 'Role' : 'الدور'}: ${p.role}\n`;
                    if (p.tools) text += `  ${isEnglish ? 'Tools' : 'الأدوات'}: ${p.tools}\n`;
                    if (p.result) text += `  ${isEnglish ? 'Result' : 'النتيجة'}: ${p.result}\n`;
                    text += '\n';
                });
            }

            // Volunteering
            if (cvData.volunteering.length > 0) {
                text += `${isEnglish ? 'VOLUNTEERING' : 'التطوع'}\n`;
                text += '-'.repeat(30) + '\n';
                cvData.volunteering.filter(v => v.name).forEach(v => {
                    text += `• ${v.name}`;
                    if (v.organization) text += ` - ${v.organization}`;
                    text += '\n';
                    text += `  ${v.startDate} - ${v.endDate || (isEnglish ? 'Present' : 'حتى الآن')}\n`;
                    if (v.tasks) text += `  ${v.tasks}\n`;
                    text += '\n';
                });
            }
            
            // Training
            if (cvData.training.length > 0) {
                text += `${isEnglish ? 'TRAINING PROGRAMS' : 'البرامج التدريبية'}\n`;
                text += '-'.repeat(30) + '\n';
                cvData.training.filter(t => t.name).forEach(t => {
                    text += `• ${t.name} - ${t.provider} (${t.month}/${t.year})\n`;
                    if (t.learned) text += `  ${t.learned}\n`;
                });
                text += '\n';
            }
            
            // Courses
            if (cvData.courses.length > 0) {
                text += `${isEnglish ? 'ONLINE COURSES' : 'الكورسات الإلكترونية'}\n`;
                text += '-'.repeat(30) + '\n';
                cvData.courses.filter(c => c.name).forEach(c => {
                    text += `• ${c.name} - ${c.provider} (${c.month}/${c.year})\n`;
                    if (c.learned) text += `  ${c.learned}\n`;
                });
                text += '\n';
            }
            
            // Certificates
            if (cvData.certificates.length > 0) {
                text += `${isEnglish ? 'CERTIFICATES' : 'الشهادات المهنية'}\n`;
                text += '-'.repeat(30) + '\n';
                cvData.certificates.filter(c => c.name).forEach(c => {
                    text += `• ${c.name} - ${c.issuer} (${c.month}/${c.year})`;
                    if (c.certificateId) text += ` [ID: ${c.certificateId}]`;
                    text += '\n';
                });
                text += '\n';
            }
            
            // Skills
            if (cvData.skills.length > 0) {
                text += `${isEnglish ? 'SKILLS' : 'المهارات'}\n`;
                text += '-'.repeat(30) + '\n';
                text += cvData.skills.join(' | ') + '\n';
                if (cvData.hasLicense) {
                    text += `${isEnglish ? 'Driving License' : 'رخصة قيادة'}: ${isEnglish ? 'Yes' : 'نعم'}\n`;
                }
                text += '\n';
            }

            // Languages
            if (cvData.languages.length > 0) {
                text += `${isEnglish ? 'LANGUAGES' : 'اللغات'}\n`;
                text += '-'.repeat(30) + '\n';
                const levelLabels = {
                    'native': isEnglish ? 'Native' : 'اللغة الأم',
                    'fluent': isEnglish ? 'Fluent' : 'طلاقة',
                    'advanced': isEnglish ? 'Advanced' : 'متقدم',
                    'intermediate': isEnglish ? 'Intermediate' : 'متوسط',
                    'basic': isEnglish ? 'Basic' : 'مبتدئ'
                };
                cvData.languages.filter(l => l.name).forEach(l => {
                    text += `• ${l.name}: ${levelLabels[l.level] || l.level}\n`;
                });
                text += '\n';
            }
            
            // Interests
            if (cvData.interests.length > 0) {
                const filteredInterests = cvData.interests.filter(i => i.trim());
                if (filteredInterests.length > 0) {
                    text += `${isEnglish ? 'ACTIVITIES & INTERESTS' : 'الأنشطة والاهتمامات'}\n`;
                    text += '-'.repeat(30) + '\n';
                    text += filteredInterests.join(' | ') + '\n';
                }
            }
            
            return text;
        }

        function showCVPreview() {
            const previewContent = document.getElementById('cvPreviewContent');
            previewContent.innerHTML = generateCVHTML();
            document.getElementById('cvPreviewModal').classList.add('active');
        }

        document.getElementById('closePreviewModal').addEventListener('click', function() {
            document.getElementById('cvPreviewModal').classList.remove('active');
        });

        document.getElementById('copyTextBtn').addEventListener('click', function() {
            const text = generatePlainText();
            navigator.clipboard.writeText(text).then(() => {
                showToast('تم نسخ النص بنجاح! افتح Word والصق النص (Ctrl+V)', 'success');
            }).catch(() => {
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showToast('تم نسخ النص! افتح Word والصق النص', 'success');
            });
        });

        // ========== Save & Manage CVs ==========
        function saveCV() {
            const cv = {
                id: editingCVId || generateId(),
                data: JSON.parse(JSON.stringify(cvData)),
                createdAt: editingCVId ? savedCVs.find(c => c.id === editingCVId)?.createdAt : new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            if (editingCVId) {
                const index = savedCVs.findIndex(c => c.id === editingCVId);
                if (index !== -1) {
                    savedCVs[index] = cv;
                }
            } else {
                savedCVs.push(cv);
            }
            
            saveData();
            showToast('تم حفظ السيرة الذاتية بنجاح', 'success');
            
            setTimeout(() => {
                renderMyCVs();
                showScreen('myCVsScreen');
            }, 500);
        }

        function renderMyCVs() {
            const container = document.getElementById('cvsList');
            const noCVsMsg = document.getElementById('noCVsMessage');
            
            savedCVs = JSON.parse(localStorage.getItem('agriCV_cvs')) || [];
            
            if (savedCVs.length === 0) {
                container.innerHTML = '';
                noCVsMsg.classList.remove('hidden');
                return;
            }
            
            noCVsMsg.classList.add('hidden');
            container.innerHTML = savedCVs.map(cv => {
                const isEnglish = cv.data.language === 'en';
                const createdDate = new Date(cv.createdAt).toLocaleDateString('ar-EG', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                return `
                    <div class="card">
                        <div class="flex items-start justify-between mb-4">
                            <div class="flex-1">
                                <h3 class="font-bold text-lg mb-1">${cv.data.personal.fullName || 'سيرة ذاتية'}</h3>
                                <p class="text-gray-400 text-sm mb-2">${cv.data.education.faculty || 'كلية الزراعة'}</p>
                                <div class="flex items-center gap-2">
                                    <span class="px-2 py-1 rounded-lg text-xs font-medium ${cv.data.language === 'en' ? 'bg-blue-500/20 text-blue-400' : 'bg-emerald-500/20 text-emerald-400'}">
                                        ${cv.data.language === 'en' ? 'English' : 'العربية'}
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-gray-500 text-xs mb-4">
                            <p>تم الإنشاء: ${createdDate}</p>
                        </div>
                        
                        <div class="flex gap-2">
                            <button onclick="editCV('${cv.id}')" class="btn-primary flex-1 text-sm py-2.5">تعديل</button>
                            <button onclick="viewCV('${cv.id}')" class="btn-secondary flex-1 text-sm py-2.5">معاينة</button>
                            <button onclick="deleteCV('${cv.id}')" class="px-3 py-2.5 rounded-xl bg-red-500/20 text-red-400 hover:bg-red-500/30 transition-colors" title="حذف">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function editCV(id) {
            const cv = savedCVs.find(c => c.id === id);
            if (cv) {
                editingCVId = id;
                cvData = JSON.parse(JSON.stringify(cv.data));
                currentStep = 0;
                showScreen('builderScreen');
                updateStepCounter();
                renderStepContent();
                showToast('جاري تحميل السيرة الذاتية للتعديل...', 'success');
            }
        }

        function viewCV(id) {
            const cv = savedCVs.find(c => c.id === id);
            if (cv) {
                const tempCVData = cvData;
                cvData = cv.data;
                showCVPreview();
                cvData = tempCVData;
            }
        }

        function deleteCV(id) {
            if (confirm('هل أنت متأكد من حذف هذه السيرة الذاتية؟')) {
                savedCVs = savedCVs.filter(c => c.id !== id);
                saveData();
                renderMyCVs();
                showToast('تم حذف السيرة الذاتية بنجاح', 'success');
            }
        }

        // Make functions globally available
        window.editCV = editCV;
        window.viewCV = viewCV;
        window.deleteCV = deleteCV;
        window.toggleCurrentlyWorking = toggleCurrentlyWorking;
        window.removeLink = removeLink;
        window.removeExperience = removeExperience;
        window.removeProject = removeProject;
        window.removeVolunteering = removeVolunteering;
        window.removeTraining = removeTraining;
        window.removeCourse = removeCourse;
        window.removeCertificate = removeCertificate;
        window.removeSkill = removeSkill;
        window.removeLanguage = removeLanguage;
        window.removeInterest = removeInterest;
        window.addSuggestedSkill = addSuggestedSkill;
        window.toggleHelp = toggleHelp;

        // ========== My CVs Screen Navigation ==========
        document.getElementById('backFromMyCVs').addEventListener('click', function() {
            showScreen('welcomeScreen');
        });

        document.getElementById('createFirstCV').addEventListener('click', function() {
            editingCVId = null;
            resetCVData();
            currentStep = 0;
            showScreen('builderScreen');
            updateStepCounter();
            renderStepContent();
        });

        // ========== Initialize App ==========
        function init() {
            savedCVs = JSON.parse(localStorage.getItem('agriCV_cvs')) || [];
            
            if (userData) {
                document.getElementById('welcomeName').textContent = `مرحباً، ${userData.name}`;
                document.getElementById('heroGreeting').textContent = `أهلاً بك، ${userData.name}`;
                document.getElementById('profileBtn').textContent = userData.name.charAt(0);
                showScreen('welcomeScreen');
            } else {
                showScreen('nameScreen');
            }
            
            // Close modals on outside click
            document.getElementById('cvPreviewModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
            
            document.getElementById('profileModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
            
            // Keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    document.getElementById('cvPreviewModal').classList.remove('active');
                    document.getElementById('profileModal').classList.remove('active');
                }
            });
        }

        init();
    </script>
</body>
</html>
